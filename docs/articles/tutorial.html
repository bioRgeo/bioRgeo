<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Tutorial • bioRgeo</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Tutorial">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">bioRgeo</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/tutorial.html">Tutorial</a>
    </li>
    <li>
      <a href="../articles/tutorial_mediterranean.html">Tutorial with Mediterranean example</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Tutorial</h1>
                        <h4 class="author">Pierre Denelle</h4>
            
            <h4 class="date">2020-03-03</h4>
      
      
      <div class="hidden name"><code>tutorial.Rmd</code></div>

    </div>

    
    
<style>
body {
text-align: justify}
</style>
<p>The principle of the package is illustrated by the following figure.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1">knitr<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/knitr/man/include_graphics.html">include_graphics</a></span>(<span class="st">"../figures/Bioregionalization_scheme3.png"</span>)</a></code></pre></div>
<p><img src="../figures/Bioregionalization_scheme3.png" width="2072"></p>
<p>In the following vignette, we show how <em>bioRgeo</em> package works. We use simulated datasets to illustrate how we can detect communities using various methods, ranging from bipartite network modularity to classical clustering.</p>
<p>From these segregations, we show how different maps can be compared.</p>
<div id="virtual-dataset" class="section level1">
<h1 class="hasAnchor">
<a href="#virtual-dataset" class="anchor"></a>Virtual dataset</h1>
<p><code>virtual_sp</code> is a dataset simulated that comes with the package. This dataset relies on the response curve of virtual species to a virtual raster. The virtual raster contains 10000 cells and was simulated using <code>gstat</code> R package. <a href="http://santiago.begueria.es/2010/10/generating-spatially-correlated-random-fields-with-r/">See here for details.</a></p>
<p>Each site having XY coordinates, we can plot the raster of the virtual environment layer:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1"><span class="co"># Import virtual dataset</span></a>
<a class="sourceLine" id="cb2-2" title="2"><span class="kw"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(<span class="st">"virtual_sp"</span>)</a>
<a class="sourceLine" id="cb2-3" title="3"></a>
<a class="sourceLine" id="cb2-4" title="4"><span class="co"># Only species data.frame</span></a>
<a class="sourceLine" id="cb2-5" title="5">sp_df &lt;-<span class="st"> </span>virtual[[<span class="dv">1</span>]]</a>
<a class="sourceLine" id="cb2-6" title="6"></a>
<a class="sourceLine" id="cb2-7" title="7"><span class="co"># Plot of environmental values</span></a>
<a class="sourceLine" id="cb2-8" title="8">sp_df <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb2-9" title="9"><span class="st">  </span><span class="kw">distinct</span>(site, <span class="dt">.keep_all =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb2-10" title="10"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(x, y)) <span class="op">+</span></a>
<a class="sourceLine" id="cb2-11" title="11"><span class="st">  </span><span class="kw">geom_tile</span>(<span class="kw">aes</span>(<span class="dt">fill =</span> env, <span class="dt">color =</span> env),</a>
<a class="sourceLine" id="cb2-12" title="12">            <span class="dt">alpha =</span> <span class="fl">0.8</span>, <span class="dt">width =</span> <span class="dv">1</span>, <span class="dt">height =</span> <span class="dv">1</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb2-13" title="13"><span class="st">  </span><span class="kw">scale_color_distiller</span>(<span class="st">"Value"</span>, <span class="dt">palette =</span> <span class="st">"OrRd"</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb2-14" title="14"><span class="st">  </span><span class="kw">scale_fill_distiller</span>(<span class="st">"Value"</span>, <span class="dt">palette =</span> <span class="st">"OrRd"</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb2-15" title="15"><span class="st">  </span><span class="kw">coord_equal</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb2-16" title="16"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">"Environmental variable"</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb2-17" title="17"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">"transparent"</span>, <span class="dt">colour =</span> <span class="ot">NA</span>))</a></code></pre></div>
<p><img src="tutorial_files/figure-html/dataset-1.png" width="768"></p>
<p>Based on this raster, we used <code>virtualspecies</code> R package (Leroy et al. 2015) to simulate a Gaussian response curve of 100 virtual species. The mean and standard deviation of the response function varied among species, drawing a continuum of generalist and specialist species.</p>
<p>We here illustrate two contrasted response curves:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1">knitr<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/knitr/man/include_graphics.html">include_graphics</a></span>(<span class="st">"../figures/sp50_response_curve.png"</span>)</a></code></pre></div>
<p><img src="../figures/sp50_response_curve.png" width="359"></p>
<p>For every species in every cell, we could derive a suitability index. Species with suitability index inferior to 0.15 were arbitrarily set absent.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1">knitr<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/knitr/man/include_graphics.html">include_graphics</a></span>(<span class="st">"../figures/sp50_suitability.png"</span>)</a></code></pre></div>
<p><img src="../figures/sp50_suitability.png" width="377"></p>
</div>
<div id="inputs-of-the-package" class="section level1">
<h1 class="hasAnchor">
<a href="#inputs-of-the-package" class="anchor"></a>Inputs of the package</h1>
<p><em>bioRgeo</em> R package relies on two possible inputs as illustrated in the following figure. Several functions of the package necessitate to define the structure of the input. User can switch from one input or the other using either <em>contingency()</em> or <em>contingency_to_dataframe()</em> functions.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" title="1">knitr<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/knitr/man/include_graphics.html">include_graphics</a></span>(<span class="st">"../figures/20200225_bioRgeo_inputs.png"</span>)</a></code></pre></div>
<p><img src="../figures/20200225_bioRgeo_inputs.png" width="1714"></p>
<p>In our case, we can easily convert the input data.frame into a contingency table, using the <em>contingency()</em> function:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" title="1">sp_mat &lt;-<span class="st"> </span><span class="kw"><a href="../reference/contingency.html">contingency</a></span>(sp_df[<span class="kw"><a href="https://rdrr.io/r/base/which.html">which</a></span>(sp_df<span class="op">$</span>pa <span class="op">!=</span><span class="st"> </span><span class="dv">0</span>), ],</a>
<a class="sourceLine" id="cb6-2" title="2">                      <span class="st">"site"</span>, <span class="st">"sp"</span>, <span class="dt">ab =</span> <span class="ot">NULL</span>, <span class="dt">binary =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb6-3" title="3">knitr<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span>(sp_mat[<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">5</span>])</a></code></pre></div>
<table class="table">
<thead><tr class="header">
<th></th>
<th align="right">sp1</th>
<th align="right">sp2</th>
<th align="right">sp3</th>
<th align="right">sp4</th>
<th align="right">sp5</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>site1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td>site10</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td>site100</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td>site101</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td>site102</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" title="1"><span class="co"># With weights</span></a>
<a class="sourceLine" id="cb7-2" title="2">sp_mat_w &lt;-<span class="st"> </span><span class="kw"><a href="../reference/contingency.html">contingency</a></span>(sp_df, <span class="st">"site"</span>, <span class="st">"sp"</span>, <span class="dt">ab =</span> <span class="st">"suitab"</span>, <span class="dt">binary =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb7-3" title="3">knitr<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span>(sp_mat_w[<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">5</span>])</a></code></pre></div>
<table class="table">
<thead><tr class="header">
<th></th>
<th align="right">sp1</th>
<th align="right">sp2</th>
<th align="right">sp3</th>
<th align="right">sp4</th>
<th align="right">sp5</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>site1</td>
<td align="right">0.9158657</td>
<td align="right">0.9312874</td>
<td align="right">0.9428647</td>
<td align="right">0.9517664</td>
<td align="right">0.9587522</td>
</tr>
<tr class="even">
<td>site10</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
</tr>
<tr class="odd">
<td>site100</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
</tr>
<tr class="even">
<td>site101</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
</tr>
<tr class="odd">
<td>site102</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
</tr>
</tbody>
</table>
</div>
<div id="community-detection" class="section level1">
<h1 class="hasAnchor">
<a href="#community-detection" class="anchor"></a>Community detection</h1>
<p>The core of the package relies on the aggregation of several methods that perform community detection based on distinct methods.</p>
<div id="bipartite-networks" class="section level2">
<h2 class="hasAnchor">
<a href="#bipartite-networks" class="anchor"></a>Bipartite networks</h2>
<p>Networks are called bipartite when they are constituted by two types of nodes. Each type of node can only be linked with the other type. For example, if species occur in sites, sites and species constitute two types of nodes and an occurrence of a species within a site describes a link between these two nodes.</p>
<div id="igraph" class="section level3">
<h3 class="hasAnchor">
<a href="#igraph" class="anchor"></a>igraph</h3>
<p>Several algorithms to detect community within bipartite networks. Several of them are implemented within the <em>igraph</em> package.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" title="1"><span class="co"># With fastgreedy</span></a>
<a class="sourceLine" id="cb8-2" title="2">bip &lt;-<span class="st"> </span><span class="kw"><a href="../reference/algo_bipartite.html">algo_bipartite</a></span>(<span class="dt">dat =</span> sp_mat, <span class="dt">algo =</span> <span class="st">"greedy"</span>, <span class="dt">weight =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb8-3" title="3"></a>
<a class="sourceLine" id="cb8-4" title="4"><span class="co"># fastgreedy, input data frame</span></a>
<a class="sourceLine" id="cb8-5" title="5">bip_df &lt;-<span class="st"> </span><span class="kw"><a href="../reference/algo_bipartite.html">algo_bipartite</a></span>(<span class="dt">dat =</span> sp_df[<span class="kw"><a href="https://rdrr.io/r/base/which.html">which</a></span>(sp_df<span class="op">$</span>pa <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>), ],</a>
<a class="sourceLine" id="cb8-6" title="6">                         <span class="dt">algo =</span> <span class="st">"greedy"</span>,</a>
<a class="sourceLine" id="cb8-7" title="7">                         <span class="dt">weight =</span> <span class="ot">FALSE</span>, <span class="dt">input =</span> <span class="st">"data frame"</span>, <span class="dt">site =</span> <span class="st">"site"</span>,</a>
<a class="sourceLine" id="cb8-8" title="8">                         <span class="dt">sp =</span> <span class="st">"sp"</span>, <span class="dt">ab =</span> <span class="ot">NULL</span>)</a>
<a class="sourceLine" id="cb8-9" title="9"></a>
<a class="sourceLine" id="cb8-10" title="10"><span class="kw"><a href="https://rdrr.io/r/base/table.html">table</a></span>(bip<span class="op">$</span>module); <span class="kw"><a href="https://rdrr.io/r/base/table.html">table</a></span>(bip_df<span class="op">$</span>module)</a></code></pre></div>
<pre><code>## 
##   1   2   3   4   5   6   7   8   9 
##  98 101  61  78  53  46  25  16  12</code></pre>
<pre><code>## 
##   1  10   2   3   4   5   6   7   8   9 
## 101  12  99  42  78  52  19  46  25  16</code></pre>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" title="1"><span class="co"># With Beckett algorithm</span></a>
<a class="sourceLine" id="cb11-2" title="2">bip2 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/algo_bipartite.html">algo_bipartite</a></span>(<span class="dt">dat =</span> sp_mat, <span class="dt">algo =</span> <span class="st">"LPAwb"</span>, <span class="dt">weight =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb11-3" title="3"></a>
<a class="sourceLine" id="cb11-4" title="4"><span class="co"># With Infomap</span></a>
<a class="sourceLine" id="cb11-5" title="5">bip_infomap &lt;-<span class="st"> </span><span class="kw"><a href="../reference/algo_bipartite.html">algo_bipartite</a></span>(<span class="dt">dat =</span> sp_mat, <span class="dt">algo =</span> <span class="st">"infomap"</span>, <span class="dt">weight =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb11-6" title="6"></a>
<a class="sourceLine" id="cb11-7" title="7"><span class="co"># Only sites</span></a>
<a class="sourceLine" id="cb11-8" title="8">bip_site &lt;-<span class="st"> </span>bip <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb11-9" title="9"><span class="st">  </span><span class="kw"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span>(cat <span class="op">==</span><span class="st"> "site"</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb11-10" title="10"><span class="st">  </span><span class="kw">rename</span>(<span class="dt">site =</span> node) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb11-11" title="11"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span>(site, module)</a>
<a class="sourceLine" id="cb11-12" title="12"></a>
<a class="sourceLine" id="cb11-13" title="13">bip_site2 &lt;-<span class="st"> </span>bip2 <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb11-14" title="14"><span class="st">  </span><span class="kw"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span>(cat <span class="op">==</span><span class="st"> "site"</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb11-15" title="15"><span class="st">  </span><span class="kw">rename</span>(<span class="dt">site =</span> node) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb11-16" title="16"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span>(site, module)</a>
<a class="sourceLine" id="cb11-17" title="17"></a>
<a class="sourceLine" id="cb11-18" title="18">bip_site_infomap &lt;-<span class="st"> </span>bip_infomap <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb11-19" title="19"><span class="st">  </span><span class="kw"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span>(cat <span class="op">==</span><span class="st"> "site"</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb11-20" title="20"><span class="st">  </span><span class="kw">rename</span>(<span class="dt">site =</span> node) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb11-21" title="21"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span>(site, module)</a></code></pre></div>
</div>
<div id="infomap" class="section level3">
<h3 class="hasAnchor">
<a href="#infomap" class="anchor"></a>Infomap</h3>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" title="1">db &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="dt">sites =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"site1"</span>, <span class="st">"site1"</span>, <span class="st">"site2"</span>, <span class="st">"site2"</span>),</a>
<a class="sourceLine" id="cb12-2" title="2">                 <span class="dt">species =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"A"</span>, <span class="st">"C"</span>),</a>
<a class="sourceLine" id="cb12-3" title="3">                 <span class="dt">abundance =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">5</span>, <span class="dv">2</span>, <span class="dv">7</span>, <span class="dv">1</span>))</a>
<a class="sourceLine" id="cb12-4" title="4"></a>
<a class="sourceLine" id="cb12-5" title="5">po=<span class="kw">writePajek</span>(<span class="dt">db =</span> db, <span class="dt">site.field =</span> <span class="st">"sites"</span>, <span class="dt">species.field =</span> <span class="st">"species"</span>,</a>
<a class="sourceLine" id="cb12-6" title="6">           <span class="dt">filename =</span> <span class="st">"pajektest.net"</span>)</a>
<a class="sourceLine" id="cb12-7" title="7"></a>
<a class="sourceLine" id="cb12-8" title="8">writePajek &lt;-<span class="st"> </span><span class="cf">function</span>(db, <span class="dt">site.field =</span> <span class="dv">1</span>, <span class="dt">species.field =</span> <span class="dv">2</span>, filename, <span class="dt">abundance.field =</span> <span class="ot">NULL</span>){</a>
<a class="sourceLine" id="cb12-9" title="9">  <span class="cf">if</span>(<span class="op">!</span><span class="kw"><a href="https://rdrr.io/r/base/factor.html">is.factor</a></span>(db[, species.field])){</a>
<a class="sourceLine" id="cb12-10" title="10">    db[, species.field] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span>(db[, species.field])</a>
<a class="sourceLine" id="cb12-11" title="11">  }</a>
<a class="sourceLine" id="cb12-12" title="12">  <span class="cf">if</span>(<span class="op">!</span><span class="kw"><a href="https://rdrr.io/r/base/factor.html">is.factor</a></span>(db[, site.field])){</a>
<a class="sourceLine" id="cb12-13" title="13">    db[, site.field] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span>(db[, site.field])</a>
<a class="sourceLine" id="cb12-14" title="14">  }</a>
<a class="sourceLine" id="cb12-15" title="15">  </a>
<a class="sourceLine" id="cb12-16" title="16">  species &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="dt">sp =</span> <span class="kw"><a href="https://rdrr.io/r/base/levels.html">levels</a></span>(db[, species.field]),</a>
<a class="sourceLine" id="cb12-17" title="17">                        <span class="dt">id =</span> <span class="dv">1</span><span class="op">:</span><span class="kw"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/levels.html">levels</a></span>(db[, species.field])))</a>
<a class="sourceLine" id="cb12-18" title="18">  sites &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="dt">site =</span> <span class="kw"><a href="https://rdrr.io/r/base/levels.html">levels</a></span>(db[, site.field]),</a>
<a class="sourceLine" id="cb12-19" title="19">                      <span class="dt">id =</span> <span class="kw"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/levels.html">levels</a></span>(db[, species.field])) <span class="op">+</span></a>
<a class="sourceLine" id="cb12-20" title="20"><span class="st">                        </span><span class="dv">1</span><span class="op">:</span><span class="kw"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/levels.html">levels</a></span>(db[, site.field])))</a>
<a class="sourceLine" id="cb12-21" title="21">  </a>
<a class="sourceLine" id="cb12-22" title="22">  links &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="dt">from =</span> species<span class="op">$</span>id[<span class="kw"><a href="https://rdrr.io/r/base/match.html">match</a></span>(db[, species.field], species<span class="op">$</span>sp)],</a>
<a class="sourceLine" id="cb12-23" title="23">                      <span class="dt">to =</span> sites<span class="op">$</span>id[<span class="kw"><a href="https://rdrr.io/r/base/match.html">match</a></span>(db[, site.field], sites<span class="op">$</span>site)],</a>
<a class="sourceLine" id="cb12-24" title="24">                      <span class="dt">weight =</span> <span class="kw"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/length.html">length</a></span>(abundance.field), <span class="kw"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(db)),</a>
<a class="sourceLine" id="cb12-25" title="25">                                      db[, abundance.field],</a>
<a class="sourceLine" id="cb12-26" title="26">                                      <span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="dv">1</span>, <span class="kw"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(db))))</a>
<a class="sourceLine" id="cb12-27" title="27">  </a>
<a class="sourceLine" id="cb12-28" title="28">  <span class="kw"><a href="https://rdrr.io/r/base/cat.html">cat</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/paste.html">paste</a></span>(<span class="st">"*Vertices "</span>, <span class="kw"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span>(sites<span class="op">$</span>id), <span class="st">"</span><span class="ch">\n</span><span class="st">"</span>,</a>
<a class="sourceLine" id="cb12-29" title="29">            <span class="kw"><a href="https://rdrr.io/r/base/paste.html">paste</a></span>(species<span class="op">$</span>id, <span class="st">' "'</span>, species<span class="op">$</span>sp, <span class="st">'"'</span>, <span class="dt">sep =</span> <span class="st">""</span>,</a>
<a class="sourceLine" id="cb12-30" title="30">                  <span class="dt">collapse =</span> <span class="st">"</span><span class="ch">\n</span><span class="st">"</span>), <span class="st">"</span><span class="ch">\n</span><span class="st">"</span>,</a>
<a class="sourceLine" id="cb12-31" title="31">            <span class="kw"><a href="https://rdrr.io/r/base/paste.html">paste</a></span>(sites<span class="op">$</span>id, <span class="st">' "'</span>, sites<span class="op">$</span>site, <span class="st">'"'</span>, <span class="dt">sep =</span> <span class="st">""</span>, <span class="dt">collapse =</span> <span class="st">"</span><span class="ch">\n</span><span class="st">"</span>),</a>
<a class="sourceLine" id="cb12-32" title="32">            <span class="st">"</span><span class="ch">\n</span><span class="st">"</span>, <span class="st">"*Edges</span><span class="ch">\n</span><span class="st">"</span>,</a>
<a class="sourceLine" id="cb12-33" title="33">            <span class="kw"><a href="https://rdrr.io/r/base/paste.html">paste</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/apply.html">apply</a></span>(links, <span class="dv">1</span>, paste, <span class="dt">collapse =</span> <span class="st">" "</span>), <span class="dt">collapse =</span> <span class="st">"</span><span class="ch">\n</span><span class="st">"</span>),</a>
<a class="sourceLine" id="cb12-34" title="34">            <span class="dt">sep =</span> <span class="st">""</span>), <span class="dt">file =</span> filename)</a>
<a class="sourceLine" id="cb12-35" title="35">}</a>
<a class="sourceLine" id="cb12-36" title="36"></a>
<a class="sourceLine" id="cb12-37" title="37"><span class="kw">writePajek</span>(fish, </a>
<a class="sourceLine" id="cb12-38" title="38">           <span class="dt">site.field =</span> <span class="st">"X1.Basin.Name"</span>, <span class="co"># Name of your site column</span></a>
<a class="sourceLine" id="cb12-39" title="39">           <span class="dt">species.field =</span> <span class="st">"X6.Fishbase.Valid.Species.Name"</span>, <span class="co"># Name of your species column</span></a>
<a class="sourceLine" id="cb12-40" title="40">           <span class="dt">filename =</span> <span class="st">"fish.net"</span>, <span class="co"># Name of the output file</span></a>
<a class="sourceLine" id="cb12-41" title="41">           <span class="dt">abundance.field =</span> <span class="ot">NULL</span>)</a>
<a class="sourceLine" id="cb12-42" title="42"></a>
<a class="sourceLine" id="cb12-43" title="43">Bio_dir &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/list.files.html">list.dirs</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/libPaths.html">.libPaths</a></span>(), <span class="dt">recursive =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb12-44" title="44">Bio_dir &lt;-<span class="st"> </span>Bio_dir[<span class="kw"><a href="https://rdrr.io/r/base/grep.html">grep</a></span>(<span class="st">"bioRgeo"</span>, Bio_dir)]</a>
<a class="sourceLine" id="cb12-45" title="45"></a>
<a class="sourceLine" id="cb12-46" title="46">Bio_dir &lt;-<span class="st"> "D:/Irstea/CarHab/Bioregionalization_extra/bin/INFOMAP/"</span></a>
<a class="sourceLine" id="cb12-47" title="47"></a>
<a class="sourceLine" id="cb12-48" title="48"><span class="co"># Change working directory so the file is saved in the proper place</span></a>
<a class="sourceLine" id="cb12-49" title="49">current_path &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/getwd.html">getwd</a></span>()</a>
<a class="sourceLine" id="cb12-50" title="50"><span class="kw"><a href="https://rdrr.io/r/base/getwd.html">setwd</a></span>(Bio_dir)</a>
<a class="sourceLine" id="cb12-51" title="51"></a>
<a class="sourceLine" id="cb12-52" title="52"><span class="co"># Convert dat to Pajek format (readable by Infomap)</span></a>
<a class="sourceLine" id="cb12-53" title="53">  <span class="cf">if</span>(<span class="op">!</span><span class="kw"><a href="https://rdrr.io/r/base/factor.html">is.factor</a></span>(dat[, sp])){</a>
<a class="sourceLine" id="cb12-54" title="54">    dat[, sp] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span>(dat[, sp])</a>
<a class="sourceLine" id="cb12-55" title="55">  }</a>
<a class="sourceLine" id="cb12-56" title="56">  <span class="cf">if</span>(<span class="op">!</span><span class="kw"><a href="https://rdrr.io/r/base/factor.html">is.factor</a></span>(dat[, site])){</a>
<a class="sourceLine" id="cb12-57" title="57">    dat[, site] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span>(dat[, site])</a>
<a class="sourceLine" id="cb12-58" title="58">  }</a>
<a class="sourceLine" id="cb12-59" title="59"></a>
<a class="sourceLine" id="cb12-60" title="60">  species &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="dt">sp =</span> <span class="kw"><a href="https://rdrr.io/r/base/levels.html">levels</a></span>(dat[, sp]),</a>
<a class="sourceLine" id="cb12-61" title="61">                        <span class="dt">id =</span> <span class="dv">1</span><span class="op">:</span><span class="kw"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/levels.html">levels</a></span>(dat[, sp])))</a>
<a class="sourceLine" id="cb12-62" title="62">  sites &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="dt">site =</span> <span class="kw"><a href="https://rdrr.io/r/base/levels.html">levels</a></span>(dat[, site]),</a>
<a class="sourceLine" id="cb12-63" title="63">                      <span class="dt">id =</span> <span class="kw"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/levels.html">levels</a></span>(dat[, sp])) <span class="op">+</span></a>
<a class="sourceLine" id="cb12-64" title="64"><span class="st">                        </span><span class="dv">1</span><span class="op">:</span><span class="kw"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/levels.html">levels</a></span>(dat[, site])))</a>
<a class="sourceLine" id="cb12-65" title="65"></a>
<a class="sourceLine" id="cb12-66" title="66">  links &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="dt">from =</span> species<span class="op">$</span>id[<span class="kw"><a href="https://rdrr.io/r/base/match.html">match</a></span>(dat[, sp], species<span class="op">$</span>sp)],</a>
<a class="sourceLine" id="cb12-67" title="67">                      <span class="dt">to =</span> sites<span class="op">$</span>id[<span class="kw"><a href="https://rdrr.io/r/base/match.html">match</a></span>(dat[, site], sites<span class="op">$</span>site)],</a>
<a class="sourceLine" id="cb12-68" title="68">                      <span class="dt">weight =</span> <span class="kw"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/length.html">length</a></span>(ab), <span class="kw"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(dat)),</a>
<a class="sourceLine" id="cb12-69" title="69">                                      dat[, ab],</a>
<a class="sourceLine" id="cb12-70" title="70">                                      <span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="dv">1</span>, <span class="kw"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(dat))))</a>
<a class="sourceLine" id="cb12-71" title="71"></a>
<a class="sourceLine" id="cb12-72" title="72">  <span class="kw"><a href="https://rdrr.io/r/base/cat.html">cat</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">"*Vertices "</span>, <span class="kw"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span>(sites<span class="op">$</span>id), <span class="st">"</span><span class="ch">\n</span><span class="st">"</span>,</a>
<a class="sourceLine" id="cb12-73" title="73">             <span class="kw"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(species<span class="op">$</span>id, <span class="st">' "'</span>, species<span class="op">$</span>sp, <span class="st">'"'</span>, <span class="dt">collapse =</span> <span class="st">"</span><span class="ch">\n</span><span class="st">"</span>), <span class="st">"</span><span class="ch">\n</span><span class="st">"</span>,</a>
<a class="sourceLine" id="cb12-74" title="74">             <span class="kw"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(sites<span class="op">$</span>id, <span class="st">' "'</span>, sites<span class="op">$</span>site, <span class="st">'"'</span>, <span class="dt">collapse =</span> <span class="st">"</span><span class="ch">\n</span><span class="st">"</span>),</a>
<a class="sourceLine" id="cb12-75" title="75">             <span class="st">"</span><span class="ch">\n</span><span class="st">"</span>, <span class="st">"*Edges</span><span class="ch">\n</span><span class="st">"</span>,</a>
<a class="sourceLine" id="cb12-76" title="76">             <span class="kw"><a href="https://rdrr.io/r/base/paste.html">paste</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/apply.html">apply</a></span>(links, <span class="dv">1</span>, paste, <span class="dt">collapse =</span> <span class="st">" "</span>), <span class="dt">collapse =</span> <span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)),</a>
<a class="sourceLine" id="cb12-77" title="77">      <span class="dt">file =</span> <span class="st">"dat_Pajek.net"</span>)</a>
<a class="sourceLine" id="cb12-78" title="78"></a>
<a class="sourceLine" id="cb12-79" title="79"><span class="co"># Set up the command with required parameters</span></a>
<a class="sourceLine" id="cb12-80" title="80">cmd &lt;-</a>
<a class="sourceLine" id="cb12-81" title="81"><span class="st">  </span><span class="kw"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(Bio_dir,</a>
<a class="sourceLine" id="cb12-82" title="82">         <span class="st">"Infomap_win -N 10 --undirected --two-level --map --clu --tree</span></a>
<a class="sourceLine" id="cb12-83" title="83"><span class="st">             --markov-time 0.5 test_uni_inf.txt test"</span>)</a>
<a class="sourceLine" id="cb12-84" title="84"><span class="kw"><a href="https://rdrr.io/r/base/system.html">system</a></span>(<span class="dt">command =</span> cmd)</a></code></pre></div>
</div>
</div>
<div id="projected-networks" class="section level2">
<h2 class="hasAnchor">
<a href="#projected-networks" class="anchor"></a>Projected networks</h2>
<p>A projected network considers the similarity between each pair of nodes. In our case, nodes can represent different sites that are linked together according the proportion of species they share together.</p>
<div id="projection-of-the-network" class="section level3">
<h3 class="hasAnchor">
<a href="#projection-of-the-network" class="anchor"></a>Projection of the network</h3>
<p>To project the network, we can use the <em>project_network()</em> function.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" title="1">sp_proj &lt;-<span class="st"> </span><span class="kw"><a href="../reference/project_network.html">project_network</a></span>(sp_mat, <span class="dt">similarity =</span> <span class="st">"simpson"</span>)</a>
<a class="sourceLine" id="cb13-2" title="2">sp_proj &lt;-<span class="st"> </span>sp_proj[, <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"id1"</span>, <span class="st">"id2"</span>, <span class="st">"simpson"</span>)]</a>
<a class="sourceLine" id="cb13-3" title="3"></a>
<a class="sourceLine" id="cb13-4" title="4">knitr<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span>(<span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(sp_proj))</a></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="right">id1</th>
<th align="right">id2</th>
<th align="right">simpson</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">4</td>
<td align="right">6</td>
<td align="right">1.0000000</td>
</tr>
<tr class="even">
<td align="right">7</td>
<td align="right">8</td>
<td align="right">1.0000000</td>
</tr>
<tr class="odd">
<td align="right">7</td>
<td align="right">9</td>
<td align="right">0.8571429</td>
</tr>
<tr class="even">
<td align="right">8</td>
<td align="right">9</td>
<td align="right">1.0000000</td>
</tr>
<tr class="odd">
<td align="right">5</td>
<td align="right">10</td>
<td align="right">0.6666667</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="right">11</td>
<td align="right">1.0000000</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" title="1"><span class="co"># With data frame input</span></a>
<a class="sourceLine" id="cb14-2" title="2">sp_proj_df &lt;-<span class="st"> </span><span class="kw"><a href="../reference/project_network.html">project_network</a></span>(sp_df[<span class="kw"><a href="https://rdrr.io/r/base/which.html">which</a></span>(sp_df<span class="op">$</span>pa <span class="op">!=</span><span class="st"> </span><span class="dv">0</span>), ],</a>
<a class="sourceLine" id="cb14-3" title="3">                              <span class="dt">similarity =</span> <span class="st">"simpson"</span>, <span class="dt">input =</span> <span class="st">"data frame"</span>,</a>
<a class="sourceLine" id="cb14-4" title="4">                              <span class="dt">site =</span> <span class="st">"site"</span>, <span class="dt">sp =</span> <span class="st">"sp"</span>)</a>
<a class="sourceLine" id="cb14-5" title="5">sp_proj_df &lt;-<span class="st"> </span>sp_proj_df[, <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"id1"</span>, <span class="st">"id2"</span>, <span class="st">"simpson"</span>)]</a>
<a class="sourceLine" id="cb14-6" title="6"></a>
<a class="sourceLine" id="cb14-7" title="7">knitr<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span>(<span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(sp_proj_df))</a></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="right">id1</th>
<th align="right">id2</th>
<th align="right">simpson</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">4</td>
<td align="right">6</td>
<td align="right">1.0000000</td>
</tr>
<tr class="even">
<td align="right">7</td>
<td align="right">8</td>
<td align="right">1.0000000</td>
</tr>
<tr class="odd">
<td align="right">7</td>
<td align="right">9</td>
<td align="right">0.8571429</td>
</tr>
<tr class="even">
<td align="right">8</td>
<td align="right">9</td>
<td align="right">1.0000000</td>
</tr>
<tr class="odd">
<td align="right">5</td>
<td align="right">10</td>
<td align="right">0.6666667</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="right">11</td>
<td align="right">1.0000000</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" title="1"><span class="co"># Bray-Curtis dissimilarity can take into account abundances of species</span></a>
<a class="sourceLine" id="cb15-2" title="2">sp_proj_w &lt;-<span class="st"> </span><span class="kw"><a href="../reference/project_network.html">project_network</a></span>(sp_mat_w, <span class="dt">similarity =</span> <span class="st">"bray"</span>)</a>
<a class="sourceLine" id="cb15-3" title="3">sp_proj_w &lt;-<span class="st"> </span>sp_proj_w[, <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"id1"</span>, <span class="st">"id2"</span>, <span class="st">"bray"</span>)]</a>
<a class="sourceLine" id="cb15-4" title="4"></a>
<a class="sourceLine" id="cb15-5" title="5">knitr<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span>(<span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(sp_proj_w))</a></code></pre></div>
<table class="table">
<thead><tr class="header">
<th></th>
<th align="right">id1</th>
<th align="right">id2</th>
<th align="right">bray</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>2</td>
<td align="right">2</td>
<td align="right">1</td>
<td align="right">0.0162964</td>
</tr>
<tr class="even">
<td>3</td>
<td align="right">3</td>
<td align="right">1</td>
<td align="right">0.0000000</td>
</tr>
<tr class="odd">
<td>4</td>
<td align="right">4</td>
<td align="right">1</td>
<td align="right">0.0005101</td>
</tr>
<tr class="even">
<td>5</td>
<td align="right">5</td>
<td align="right">1</td>
<td align="right">0.0000020</td>
</tr>
<tr class="odd">
<td>6</td>
<td align="right">6</td>
<td align="right">1</td>
<td align="right">0.0002640</td>
</tr>
<tr class="even">
<td>7</td>
<td align="right">7</td>
<td align="right">1</td>
<td align="right">0.0016733</td>
</tr>
</tbody>
</table>
</div>
<div id="order-statistics-local-optimization-method-oslom" class="section level3">
<h3 class="hasAnchor">
<a href="#order-statistics-local-optimization-method-oslom" class="anchor"></a>Order Statistics Local Optimization Method (OSLOM)</h3>
<p>Running OSLOM. tp files containing the modularity results are directly stored within the virtual dataset, but the following chunk can be run independently.</p>
<p>Output of OSLOM are stored in a chosen directory and can be import into R with the command <code><a href="https://rdrr.io/r/base/readRDS.html">readRDS()</a></code>.</p>
<p>Code compiled, original from here. Lancichinetti et al. (2011)</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" title="1"><span class="kw">run_oslom</span>(sp_proj, <span class="dt">n_runs =</span> <span class="dv">5</span>, <span class="dt">t_param =</span> <span class="fl">0.1</span>, <span class="dt">cp_param =</span> <span class="fl">0.5</span>,</a>
<a class="sourceLine" id="cb16-2" title="2">          <span class="dt">saving_directory =</span> <span class="st">"D:/Irstea/CarHab/Bioregionalization_extra"</span>)</a>
<a class="sourceLine" id="cb16-3" title="3"></a>
<a class="sourceLine" id="cb16-4" title="4">res &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span>(<span class="st">"D:/Irstea/CarHab/Bioregionalization_extra/tp.rds"</span>)</a>
<a class="sourceLine" id="cb16-5" title="5"><span class="kw"><a href="https://rdrr.io/r/base/files.html">file.rename</a></span>(<span class="st">"D:/Irstea/CarHab/Bioregionalization_extra/tp.rds"</span>,</a>
<a class="sourceLine" id="cb16-6" title="6">            <span class="st">"D:/Irstea/CarHab/Bioregionalization_extra/tp_binary.rds"</span>)</a>
<a class="sourceLine" id="cb16-7" title="7"><span class="co"># With weights</span></a>
<a class="sourceLine" id="cb16-8" title="8"><span class="kw">run_oslom</span>(sp_proj_w, <span class="dt">n_runs =</span> <span class="dv">5</span>, <span class="dt">t_param =</span> <span class="fl">0.1</span>, <span class="dt">cp_param =</span> <span class="fl">0.5</span>,</a>
<a class="sourceLine" id="cb16-9" title="9">          <span class="dt">saving_directory =</span> <span class="st">"D:/Irstea/CarHab/Bioregionalization_extra/"</span>)</a>
<a class="sourceLine" id="cb16-10" title="10"></a>
<a class="sourceLine" id="cb16-11" title="11">res_w &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span>(<span class="st">"D:/Irstea/CarHab/Bioregionalization_extra/tp.rds"</span>)</a></code></pre></div>
<p>Converting the OSLOM .tp file into a list.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" title="1"><span class="co"># Format OSLOM output into a data.frame</span></a>
<a class="sourceLine" id="cb17-2" title="2">oslom_vignette &lt;-<span class="st"> </span><span class="kw"><a href="../reference/oslom_output.html">oslom_output</a></span>(virtual[[<span class="dv">2</span>]], sp_mat)</a>
<a class="sourceLine" id="cb17-3" title="3"><span class="co"># With weights</span></a>
<a class="sourceLine" id="cb17-4" title="4">oslom_vignette_w &lt;-<span class="st"> </span><span class="kw"><a href="../reference/oslom_output.html">oslom_output</a></span>(virtual[[<span class="dv">3</span>]], sp_mat_w)</a>
<a class="sourceLine" id="cb17-5" title="5"></a>
<a class="sourceLine" id="cb17-6" title="6"><span class="kw"><a href="https://rdrr.io/r/base/print.html">print</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">"Number of bioregions detected = "</span>,</a>
<a class="sourceLine" id="cb17-7" title="7">             <span class="kw"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/unique.html">unique</a></span>(oslom_vignette<span class="op">$</span>bioregion)),</a>
<a class="sourceLine" id="cb17-8" title="8">             <span class="st">" ; and with weights: "</span>,</a>
<a class="sourceLine" id="cb17-9" title="9">             <span class="kw"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/unique.html">unique</a></span>(oslom_vignette_w<span class="op">$</span>bioregion))))</a></code></pre></div>
<pre><code>## [1] "Number of bioregions detected = 9 ; and with weights: 6"</code></pre>
</div>
</div>
<div id="clustering" class="section level2">
<h2 class="hasAnchor">
<a href="#clustering" class="anchor"></a>Clustering</h2>
<p>Other methods to detect communities use more classical clustering approaches. For example, k-means clustering aims at partitionning <em>n</em> observations into <em>k</em> clusters in which each observation belongs to the cluster with the nearest mean.</p>
<p>Agglomerative Hierarchical Clustering.</p>
<p>See <a href="https://towardsdatascience.com/the-5-clustering-algorithms-data-scientists-need-to-know-a36d136ef68" class="uri">https://towardsdatascience.com/the-5-clustering-algorithms-data-scientists-need-to-know-a36d136ef68</a> to add more methods.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" title="1"><span class="co"># CA_res &lt;- CA_cluster(sp_mat)</span></a>
<a class="sourceLine" id="cb19-2" title="2">ward_res &lt;-<span class="st"> </span><span class="kw"><a href="../reference/cluster.html">cluster</a></span>(sp_mat, <span class="dt">method =</span> <span class="st">"ward.D2"</span>, <span class="dt">n_clust =</span> <span class="dv">6</span>)</a></code></pre></div>
</div>
</div>
<div id="species-contributions" class="section level1">
<h1 class="hasAnchor">
<a href="#species-contributions" class="anchor"></a>Species’ contributions</h1>
<p>This part aims at evaluating the contributions of species to the different bioregions created.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" title="1">tmp &lt;-<span class="st"> </span><span class="kw">left_join</span>(sp_df[<span class="kw"><a href="https://rdrr.io/r/base/which.html">which</a></span>(sp_df<span class="op">$</span>pa <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>), ], oslom_vignette, <span class="dt">by =</span> <span class="st">"site"</span>)</a>
<a class="sourceLine" id="cb20-2" title="2"><span class="co"># table(tmp$sp, tmp$bioregion)</span></a>
<a class="sourceLine" id="cb20-3" title="3"></a>
<a class="sourceLine" id="cb20-4" title="4">scores &lt;-<span class="st"> </span><span class="kw"><a href="../reference/contribute.html">contribute</a></span>(<span class="dt">dat =</span> tmp, <span class="dt">sp_col =</span> <span class="st">"sp"</span>, <span class="dt">site_col =</span> <span class="st">"site"</span>,</a>
<a class="sourceLine" id="cb20-5" title="5">                     <span class="dt">bioregion_col =</span> <span class="st">"bioregion"</span>)</a></code></pre></div>
<p>The following figure illustrates how the rho score from Lenormand et al. 2019 is calculated.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" title="1">knitr<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/knitr/man/include_graphics.html">include_graphics</a></span>(<span class="st">"../figures/zscore_scheme.png"</span>)</a></code></pre></div>
<p><img src="../figures/zscore_scheme.png" width="514"></p>
<p><span class="math display">\[
\rho_{ij} = \frac{n_{ij} - \frac{n_in_j}{n}}{\sqrt(\frac{n-n_j}{n-1}(1-\frac{n_j}{n})\frac{n_jn_i}{n})}
\]</span></p>
<p>Formula of Cz scores:</p>
<p><span class="math display">\[
P_{i} = 1 - \sum_{i = 1}^{N_m}{(\frac{k_{is}}{k_{i}})^2} 
\]</span></p>
<p>where Pi is the participation coefficient of node i, kis is the number of links of node i to region s, ki is the total number of links of node i and Nm is the total number of regions. We calculated the participation coefficient at each level of the biogeographical structure identified by Map Equation.</p>
<p><span class="math display">\[
z_i = \frac{k_i - \overline{k_{si}}}{\sigma_{k_{si}}}
\]</span></p>
<p>The within-module degree z-score measures how well-connected node i is to other nodes in the module.</p>
</div>
<div id="interaction-between-bioregions" class="section level1">
<h1 class="hasAnchor">
<a href="#interaction-between-bioregions" class="anchor"></a>Interaction between bioregions</h1>
<p>Following the equation of the rho score from above.</p>
<p>The interactions between the different bioregions can then be calculated following these equations:</p>
<p><span class="math display">\[
\hat\rho_{ij}^{+} = {\rho_{ij}}_{\rho_{ij}&gt;1.96}
\]</span> We normalize the rows:</p>
<p><span class="math display">\[
\hat\rho_{ij}^{+} = \frac{\rho_{ij}^{+}}{\sum_i\rho_{ij}^{+}}
\]</span></p>
<p>Finally, we determine for each bioregion how each set of species contributes to it.</p>
<p><span class="math display">\[
\lambda_{jj'} = \frac{1}{|A_j|}\sum_{i \in A_{j}}\hat\rho_{jj'}^{+}
\]</span></p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" title="1"><span class="co"># 10 sites with species richness belonging to [1, 3]</span></a>
<a class="sourceLine" id="cb22-2" title="2"><span class="kw"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb22-3" title="3">sites &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">"site"</span>, <span class="kw"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>)),</a>
<a class="sourceLine" id="cb22-4" title="4">                <span class="cf">function</span>(x) <span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(x, <span class="kw"><a href="https://rdrr.io/r/base/sample.html">sample</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>), <span class="dv">1</span>)))</a>
<a class="sourceLine" id="cb22-5" title="5"><span class="co"># Pool of 5 species distributed across the sites</span></a>
<a class="sourceLine" id="cb22-6" title="6">species &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span>(sites,</a>
<a class="sourceLine" id="cb22-7" title="7">                  <span class="cf">function</span>(x) <span class="kw"><a href="https://rdrr.io/r/base/sample.html">sample</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">"sp"</span>, <span class="kw"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>)), </a>
<a class="sourceLine" id="cb22-8" title="8">                                     <span class="kw"><a href="https://rdrr.io/r/base/length.html">length</a></span>(x), <span class="dt">replace =</span> <span class="ot">TRUE</span>))</a>
<a class="sourceLine" id="cb22-9" title="9"><span class="co"># 3 bioregions assigned randomly</span></a>
<a class="sourceLine" id="cb22-10" title="10">bioregions &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sample.html">sample</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">"bio"</span>, <span class="kw"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>)), <span class="kw"><a href="https://rdrr.io/r/base/length.html">length</a></span>(sites), <span class="dt">replace =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb22-11" title="11">bioregions &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="dt">site =</span> <span class="kw"><a href="https://rdrr.io/r/base/names.html">names</a></span>(sites),</a>
<a class="sourceLine" id="cb22-12" title="12">                         <span class="dt">bioregion =</span> bioregions)</a>
<a class="sourceLine" id="cb22-13" title="13"></a>
<a class="sourceLine" id="cb22-14" title="14"><span class="co"># Conversion to data frame</span></a>
<a class="sourceLine" id="cb22-15" title="15">fuzzy &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="dt">site =</span> <span class="kw"><a href="https://rdrr.io/r/base/character.html">as.character</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span>(sites)),</a>
<a class="sourceLine" id="cb22-16" title="16">                    <span class="dt">sp =</span> <span class="kw"><a href="https://rdrr.io/r/base/character.html">as.character</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span>(species)))</a>
<a class="sourceLine" id="cb22-17" title="17">fuzzy &lt;-<span class="st"> </span><span class="kw">left_join</span>(fuzzy, bioregions, <span class="dt">by =</span> <span class="st">"site"</span>)</a>
<a class="sourceLine" id="cb22-18" title="18"></a>
<a class="sourceLine" id="cb22-19" title="19"><span class="kw"><a href="https://rdrr.io/r/base/table.html">table</a></span>(fuzzy<span class="op">$</span>sp, fuzzy<span class="op">$</span>bioregion)</a></code></pre></div>
<pre><code>##      
##       bio1 bio2 bio3
##   sp1    2    2    2
##   sp2    1    2    2
##   sp3    0    1    1
##   sp4    1    0    1
##   sp5    1    4    1</code></pre>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb24-1" title="1"><span class="co"># Compute zscores</span></a>
<a class="sourceLine" id="cb24-2" title="2">zscores &lt;-<span class="st"> </span><span class="kw"><a href="../reference/zscore.html">zscore</a></span>(fuzzy, <span class="dt">sp_col =</span> <span class="st">"sp"</span>, <span class="dt">site_col =</span> <span class="st">"site"</span>,</a>
<a class="sourceLine" id="cb24-3" title="3">                  <span class="dt">bioregion_col =</span> <span class="st">"bioregion"</span>, <span class="dt">output_format =</span> <span class="st">"matrix"</span>)</a>
<a class="sourceLine" id="cb24-4" title="4">zscores</a></code></pre></div>
<pre><code>##      bioregion
## sp          bio1       bio2       bio3
##   sp1  0.2020305 -0.4082483  0.2020305
##   sp2 -0.5532833  0.0000000  0.5532833
##   sp3 -1.0497813  0.3535534  0.6998542
##   sp4  0.6998542 -1.4142136  0.6998542
##   sp5 -0.8081220  1.6329932 -0.8081220</code></pre>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb26-1" title="1"><span class="co"># Interactions between bioregions</span></a>
<a class="sourceLine" id="cb26-2" title="2"><span class="kw"><a href="../reference/interact.html">interact</a></span>(<span class="dt">input_network =</span> <span class="st">"projected"</span>,</a>
<a class="sourceLine" id="cb26-3" title="3">         <span class="dt">dat =</span> zscores, <span class="dt">plot =</span> <span class="ot">TRUE</span>, <span class="dt">output_format =</span> <span class="st">"matrix"</span>)</a></code></pre></div>
<pre><code>## $lambda
##          bio1     bio2     bio3
## bio1 75.00000  0.00000 25.00000
## bio2  0.00000 66.78141 33.21859
## bio3 16.66667 11.18761 72.14572
## 
## [[2]]</code></pre>
<p><img src="tutorial_files/figure-html/z_scores_dummy-1.png" width="768"></p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb28-1" title="1"><span class="co"># tmp &lt;- left_join(sp_df, oslom_vignette, by = "site")</span></a>
<a class="sourceLine" id="cb28-2" title="2">tmp &lt;-<span class="st"> </span><span class="kw">left_join</span>(sp_df[<span class="kw"><a href="https://rdrr.io/r/base/which.html">which</a></span>(sp_df<span class="op">$</span>pa <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>), ], oslom_vignette, <span class="dt">by =</span> <span class="st">"site"</span>)</a>
<a class="sourceLine" id="cb28-3" title="3"><span class="co"># table(tmp$sp, tmp$bioregion)</span></a>
<a class="sourceLine" id="cb28-4" title="4"></a>
<a class="sourceLine" id="cb28-5" title="5">z_scores &lt;-<span class="st"> </span><span class="kw"><a href="../reference/zscore.html">zscore</a></span>(tmp, <span class="dt">sp_col =</span> <span class="st">"sp"</span>, <span class="dt">site_col =</span> <span class="st">"site"</span>,</a>
<a class="sourceLine" id="cb28-6" title="6">                   <span class="dt">bioregion_col =</span> <span class="st">"bioregion"</span>, <span class="dt">output_format =</span> <span class="st">"dataframe"</span>)</a>
<a class="sourceLine" id="cb28-7" title="7"></a>
<a class="sourceLine" id="cb28-8" title="8">top10 &lt;-<span class="st"> </span>z_scores <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb28-9" title="9"><span class="st">  </span><span class="kw">group_by</span>(bioregion) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb28-10" title="10"><span class="st">  </span><span class="kw">top_n</span>(<span class="dt">n =</span> <span class="dv">10</span>, zscore) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># extract top 10</span></a>
<a class="sourceLine" id="cb28-11" title="11"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">rank =</span> <span class="kw"><a href="https://rdrr.io/r/base/rank.html">rank</a></span>(<span class="op">-</span>zscore, <span class="co"># ranking zcore in an ascending order</span></a>
<a class="sourceLine" id="cb28-12" title="12">                     <span class="dt">ties.method =</span> <span class="st">"first"</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># if tie zscore, first species</span></a>
<a class="sourceLine" id="cb28-13" title="13"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span>(sp, bioregion, zscore, rank) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb28-14" title="14"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">zscore =</span> <span class="kw"><a href="https://rdrr.io/r/base/Round.html">round</a></span>(zscore, <span class="dv">1</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># rounding zscore to 1 digit</span></a>
<a class="sourceLine" id="cb28-15" title="15"><span class="st">  </span><span class="kw"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span>()</a>
<a class="sourceLine" id="cb28-16" title="16"></a>
<a class="sourceLine" id="cb28-17" title="17">knitr<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span>(top10[<span class="kw"><a href="https://rdrr.io/r/base/which.html">which</a></span>(top10<span class="op">$</span>bioregion <span class="op">==</span><span class="st"> "2"</span>), ])</a></code></pre></div>
<table class="table">
<thead><tr class="header">
<th></th>
<th align="left">sp</th>
<th align="left">bioregion</th>
<th align="right">zscore</th>
<th align="right">rank</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>11</td>
<td align="left">sp51</td>
<td align="left">2</td>
<td align="right">13.5</td>
<td align="right">10</td>
</tr>
<tr class="even">
<td>12</td>
<td align="left">sp52</td>
<td align="left">2</td>
<td align="right">13.8</td>
<td align="right">9</td>
</tr>
<tr class="odd">
<td>13</td>
<td align="left">sp53</td>
<td align="left">2</td>
<td align="right">15.2</td>
<td align="right">8</td>
</tr>
<tr class="even">
<td>14</td>
<td align="left">sp54</td>
<td align="left">2</td>
<td align="right">15.5</td>
<td align="right">7</td>
</tr>
<tr class="odd">
<td>15</td>
<td align="left">sp55</td>
<td align="left">2</td>
<td align="right">16.3</td>
<td align="right">6</td>
</tr>
<tr class="even">
<td>16</td>
<td align="left">sp56</td>
<td align="left">2</td>
<td align="right">16.5</td>
<td align="right">5</td>
</tr>
<tr class="odd">
<td>17</td>
<td align="left">sp57</td>
<td align="left">2</td>
<td align="right">17.1</td>
<td align="right">4</td>
</tr>
<tr class="even">
<td>18</td>
<td align="left">sp58</td>
<td align="left">2</td>
<td align="right">17.2</td>
<td align="right">3</td>
</tr>
<tr class="odd">
<td>19</td>
<td align="left">sp59</td>
<td align="left">2</td>
<td align="right">18.8</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td>20</td>
<td align="left">sp60</td>
<td align="left">2</td>
<td align="right">18.7</td>
<td align="right">2</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb29-1" title="1">z_scores &lt;-<span class="st"> </span><span class="kw"><a href="../reference/zscore.html">zscore</a></span>(tmp, <span class="dt">sp_col =</span> <span class="st">"sp"</span>, <span class="dt">site_col =</span> <span class="st">"site"</span>,</a>
<a class="sourceLine" id="cb29-2" title="2">                   <span class="dt">bioregion_col =</span> <span class="st">"bioregion"</span>, <span class="dt">output_format =</span> <span class="st">"matrix"</span>)</a>
<a class="sourceLine" id="cb29-3" title="3"></a>
<a class="sourceLine" id="cb29-4" title="4">lambda &lt;-<span class="st"> </span><span class="kw"><a href="../reference/interact.html">interact</a></span>(<span class="dt">input_network =</span> <span class="st">"projected"</span>,</a>
<a class="sourceLine" id="cb29-5" title="5">                   <span class="dt">dat =</span> z_scores, <span class="dt">plot =</span> <span class="ot">TRUE</span>, <span class="dt">output_format =</span> <span class="st">"matrix"</span>)</a>
<a class="sourceLine" id="cb29-6" title="6">knitr<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span>(<span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(lambda[[<span class="dv">1</span>]]))</a></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="right">1</th>
<th align="right">2</th>
<th align="right">3</th>
<th align="right">4</th>
<th align="right">5</th>
<th align="right">6</th>
<th align="right">7</th>
<th align="right">8</th>
<th align="right">9</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">100</td>
<td align="right">0</td>
<td align="right">0.00000</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0.0000000</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="right">0</td>
<td align="right">100</td>
<td align="right">0.00000</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0.0000000</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="right">0</td>
<td align="right">0</td>
<td align="right">99.72334</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0.2766644</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0.00000</td>
<td align="right">100</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0.0000000</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0.00000</td>
<td align="right">0</td>
<td align="right">100</td>
<td align="right">0</td>
<td align="right">0.0000000</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0.00000</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">100</td>
<td align="right">0.0000000</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb30-1" title="1"><span class="co"># Plot</span></a>
<a class="sourceLine" id="cb30-2" title="2">lambda[[<span class="dv">2</span>]]</a></code></pre></div>
<p><img src="tutorial_files/figure-html/lambda-1.png" width="768"></p>
<div id="cz" class="section level2">
<h2 class="hasAnchor">
<a href="#cz" class="anchor"></a>Cz</h2>
<p>Cz computation on bipartite results.</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb31-1" title="1">bip_cz &lt;-<span class="st"> </span>bip[, <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"node"</span>, <span class="st">"module"</span>, <span class="st">"cat"</span>)]</a>
<a class="sourceLine" id="cb31-2" title="2"><span class="kw"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(bip_cz) &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"node"</span>, <span class="st">"mod"</span>, <span class="st">"cat"</span>)</a>
<a class="sourceLine" id="cb31-3" title="3"></a>
<a class="sourceLine" id="cb31-4" title="4">cz_bip &lt;-<span class="st"> </span><span class="kw"><a href="../reference/cz.html">cz</a></span>(<span class="dt">dat =</span> sp_df[<span class="kw"><a href="https://rdrr.io/r/base/which.html">which</a></span>(sp_df<span class="op">$</span>pa <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>), ], <span class="dt">sp_col =</span> <span class="st">"sp"</span>,</a>
<a class="sourceLine" id="cb31-5" title="5">             <span class="dt">site_col =</span> <span class="st">"site"</span>, <span class="dt">bip =</span> bip_cz, <span class="dt">ab =</span> <span class="ot">NULL</span>)</a>
<a class="sourceLine" id="cb31-6" title="6"></a>
<a class="sourceLine" id="cb31-7" title="7"><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(cz_bip[[<span class="dv">1</span>]])</a></code></pre></div>
<pre><code>##      node mod  cat C n_link_mod mean_link_mod sd_link_mod          z
## 1   site1   8 site 0         10       6.37500    2.362908  1.5341267
## 2  site10   3 site 0          7      10.52459    7.152171 -0.4928000
## 3 site100   7 site 0          3       7.92000    3.581434 -1.3737516
## 4 site101   1 site 0          6      12.59184   17.519848 -0.3762496
## 5 site102   2 site 0          3      12.51485   17.654809 -0.5389382
## 6 site103   1 site 0         10      12.59184   17.519848 -0.1479372</code></pre>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb33-1" title="1"><span class="co"># Interaction</span></a>
<a class="sourceLine" id="cb33-2" title="2"><span class="co"># lambda &lt;- interact(input_network = "bipartite",</span></a>
<a class="sourceLine" id="cb33-3" title="3"><span class="co">#                    dat = link_cz, plot = TRUE, output_format = "matrix")</span></a>
<a class="sourceLine" id="cb33-4" title="4"><span class="co"># knitr::kable(head(lambda[[1]]))</span></a>
<a class="sourceLine" id="cb33-5" title="5"><span class="co"># # Plot</span></a>
<a class="sourceLine" id="cb33-6" title="6"><span class="co"># lambda[[2]]</span></a></code></pre></div>
</div>
</div>
<div id="comparison-of-different-bioregionalizations" class="section level1">
<h1 class="hasAnchor">
<a href="#comparison-of-different-bioregionalizations" class="anchor"></a>Comparison of different bioregionalizations</h1>
<p>If sites have coordinates, we can apply several functions to compare how the distinct bioregions are segregated through space.</p>
<div id="projection-on-a-map-" class="section level2">
<h2 class="hasAnchor">
<a href="#projection-on-a-map-" class="anchor"></a>Projection on a map.</h2>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb34-1" title="1"><span class="kw">plot_grid</span>(</a>
<a class="sourceLine" id="cb34-2" title="2">  <span class="co"># Plot of environmental values</span></a>
<a class="sourceLine" id="cb34-3" title="3">  sp_df <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb34-4" title="4"><span class="st">    </span><span class="kw">distinct</span>(site, <span class="dt">.keep_all =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb34-5" title="5"><span class="st">    </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(x, y)) <span class="op">+</span></a>
<a class="sourceLine" id="cb34-6" title="6"><span class="st">    </span><span class="kw">geom_tile</span>(<span class="kw">aes</span>(<span class="dt">fill =</span> env, <span class="dt">color =</span> env),</a>
<a class="sourceLine" id="cb34-7" title="7">              <span class="dt">alpha =</span> <span class="fl">0.8</span>, <span class="dt">width =</span> <span class="dv">1</span>, <span class="dt">height =</span> <span class="dv">1</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb34-8" title="8"><span class="st">    </span><span class="kw">scale_color_distiller</span>(<span class="st">"Value"</span>, <span class="dt">palette =</span> <span class="st">"OrRd"</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb34-9" title="9"><span class="st">    </span><span class="kw">scale_fill_distiller</span>(<span class="st">"Value"</span>, <span class="dt">palette =</span> <span class="st">"OrRd"</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb34-10" title="10"><span class="st">    </span><span class="kw">coord_equal</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb34-11" title="11"><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">"Environmental variable"</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb34-12" title="12"><span class="st">    </span><span class="kw">theme</span>(<span class="dt">panel.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">"transparent"</span>,<span class="dt">colour =</span> <span class="ot">NA</span>)),</a>
<a class="sourceLine" id="cb34-13" title="13">  </a>
<a class="sourceLine" id="cb34-14" title="14">  <span class="co"># Plot of OSLOM bioregions</span></a>
<a class="sourceLine" id="cb34-15" title="15">  sp_df <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb34-16" title="16"><span class="st">    </span><span class="kw">left_join</span>(oslom_vignette, <span class="dt">by =</span> <span class="st">"site"</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb34-17" title="17"><span class="st">    </span><span class="kw">distinct</span>(site, <span class="dt">.keep_all =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb34-18" title="18"><span class="st">    </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(x, y)) <span class="op">+</span></a>
<a class="sourceLine" id="cb34-19" title="19"><span class="st">    </span><span class="kw">geom_tile</span>(<span class="kw">aes</span>(<span class="dt">fill =</span> <span class="kw"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span>(bioregion), <span class="dt">color =</span> <span class="kw"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span>(bioregion)),</a>
<a class="sourceLine" id="cb34-20" title="20">              <span class="dt">alpha =</span> <span class="fl">0.8</span>, <span class="dt">width =</span> <span class="dv">1</span>, <span class="dt">height =</span> <span class="dv">1</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb34-21" title="21"><span class="st">    </span><span class="kw">scale_color_brewer</span>(<span class="st">"Bioregions"</span>, <span class="dt">palette =</span> <span class="st">"Paired"</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb34-22" title="22"><span class="st">    </span><span class="kw">scale_fill_brewer</span>(<span class="st">"Bioregions"</span>, <span class="dt">palette =</span> <span class="st">"Paired"</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb34-23" title="23"><span class="st">    </span><span class="co"># scale_color_viridis_d("Bioregions", option = "E") +</span></a>
<a class="sourceLine" id="cb34-24" title="24"><span class="st">    </span><span class="co"># scale_fill_viridis_d("Bioregions", option = "E") +</span></a>
<a class="sourceLine" id="cb34-25" title="25"><span class="st">    </span><span class="kw">coord_equal</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb34-26" title="26"><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">"OSLOM bioregions"</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb34-27" title="27"><span class="st">    </span><span class="kw">theme</span>(<span class="dt">panel.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">"transparent"</span>,</a>
<a class="sourceLine" id="cb34-28" title="28">                                          <span class="dt">colour =</span> <span class="st">"black"</span>)),</a>
<a class="sourceLine" id="cb34-29" title="29">  </a>
<a class="sourceLine" id="cb34-30" title="30">  <span class="co"># Plot of Ward bioregions</span></a>
<a class="sourceLine" id="cb34-31" title="31">  sp_df <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb34-32" title="32"><span class="st">    </span><span class="kw">left_join</span>(ward_res, <span class="dt">by =</span> <span class="st">"site"</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb34-33" title="33"><span class="st">    </span><span class="kw">distinct</span>(site, <span class="dt">.keep_all =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb34-34" title="34"><span class="st">    </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(x, y)) <span class="op">+</span></a>
<a class="sourceLine" id="cb34-35" title="35"><span class="st">    </span><span class="kw">geom_tile</span>(<span class="kw">aes</span>(<span class="dt">fill =</span> <span class="kw"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span>(cluster), <span class="dt">color =</span> <span class="kw"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span>(cluster)),</a>
<a class="sourceLine" id="cb34-36" title="36">              <span class="dt">alpha =</span> <span class="fl">0.8</span>, <span class="dt">width =</span> <span class="dv">1</span>, <span class="dt">height =</span> <span class="dv">1</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb34-37" title="37"><span class="st">    </span><span class="kw">scale_color_brewer</span>(<span class="st">"Bioregions"</span>, <span class="dt">palette =</span> <span class="st">"Paired"</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb34-38" title="38"><span class="st">    </span><span class="kw">scale_fill_brewer</span>(<span class="st">"Bioregions"</span>, <span class="dt">palette =</span> <span class="st">"Paired"</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb34-39" title="39"><span class="st">    </span><span class="kw">coord_equal</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb34-40" title="40"><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">"Ward bioregions"</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb34-41" title="41"><span class="st">    </span><span class="kw">theme</span>(<span class="dt">panel.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">"transparent"</span>, <span class="dt">colour =</span> <span class="ot">NA</span>)),</a>
<a class="sourceLine" id="cb34-42" title="42">  </a>
<a class="sourceLine" id="cb34-43" title="43">  <span class="co"># Plot of fastgreedy bioregions</span></a>
<a class="sourceLine" id="cb34-44" title="44">  sp_df <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb34-45" title="45"><span class="st">    </span><span class="kw">left_join</span>(bip_site, <span class="dt">by =</span> <span class="st">"site"</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb34-46" title="46"><span class="st">    </span><span class="kw">distinct</span>(site, <span class="dt">.keep_all =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb34-47" title="47"><span class="st">    </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(x, y)) <span class="op">+</span></a>
<a class="sourceLine" id="cb34-48" title="48"><span class="st">    </span><span class="kw">geom_tile</span>(<span class="kw">aes</span>(<span class="dt">fill =</span> <span class="kw"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span>(module), <span class="dt">color =</span> <span class="kw"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span>(module)),</a>
<a class="sourceLine" id="cb34-49" title="49">              <span class="dt">alpha =</span> <span class="fl">0.8</span>, <span class="dt">width =</span> <span class="dv">1</span>, <span class="dt">height =</span> <span class="dv">1</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb34-50" title="50"><span class="st">    </span><span class="kw">scale_color_brewer</span>(<span class="st">"Bioregions"</span>, <span class="dt">palette =</span> <span class="st">"Paired"</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb34-51" title="51"><span class="st">    </span><span class="kw">scale_fill_brewer</span>(<span class="st">"Bioregions"</span>, <span class="dt">palette =</span> <span class="st">"Paired"</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb34-52" title="52"><span class="st">    </span><span class="kw">coord_equal</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb34-53" title="53"><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">"Bipartite greedy bioregions"</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb34-54" title="54"><span class="st">    </span><span class="kw">theme</span>(<span class="dt">panel.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">"transparent"</span>, <span class="dt">colour =</span> <span class="ot">NA</span>)),</a>
<a class="sourceLine" id="cb34-55" title="55">  </a>
<a class="sourceLine" id="cb34-56" title="56">  <span class="co"># Plot of LPAwb bioregions</span></a>
<a class="sourceLine" id="cb34-57" title="57">  sp_df <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb34-58" title="58"><span class="st">    </span><span class="kw">left_join</span>(bip_site2, <span class="dt">by =</span> <span class="st">"site"</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb34-59" title="59"><span class="st">    </span><span class="kw">distinct</span>(site, <span class="dt">.keep_all =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb34-60" title="60"><span class="st">    </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(x, y)) <span class="op">+</span></a>
<a class="sourceLine" id="cb34-61" title="61"><span class="st">    </span><span class="kw">geom_tile</span>(<span class="kw">aes</span>(<span class="dt">fill =</span> <span class="kw"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span>(module), <span class="dt">color =</span> <span class="kw"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span>(module)),</a>
<a class="sourceLine" id="cb34-62" title="62">              <span class="dt">alpha =</span> <span class="fl">0.8</span>, <span class="dt">width =</span> <span class="dv">1</span>, <span class="dt">height =</span> <span class="dv">1</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb34-63" title="63"><span class="st">    </span><span class="kw">scale_color_brewer</span>(<span class="st">"Bioregions"</span>, <span class="dt">palette =</span> <span class="st">"Paired"</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb34-64" title="64"><span class="st">    </span><span class="kw">scale_fill_brewer</span>(<span class="st">"Bioregions"</span>, <span class="dt">palette =</span> <span class="st">"Paired"</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb34-65" title="65"><span class="st">    </span><span class="kw">coord_equal</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb34-66" title="66"><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">"LPAwb+ greedy bioregions"</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb34-67" title="67"><span class="st">    </span><span class="kw">theme</span>(<span class="dt">panel.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">"transparent"</span>, <span class="dt">colour =</span> <span class="ot">NA</span>)),</a>
<a class="sourceLine" id="cb34-68" title="68">  </a>
<a class="sourceLine" id="cb34-69" title="69">  <span class="co"># Plot of Infomap bioregions</span></a>
<a class="sourceLine" id="cb34-70" title="70">  sp_df <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb34-71" title="71"><span class="st">    </span><span class="kw">left_join</span>(bip_site_infomap, <span class="dt">by =</span> <span class="st">"site"</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb34-72" title="72"><span class="st">    </span><span class="kw">distinct</span>(site, <span class="dt">.keep_all =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb34-73" title="73"><span class="st">    </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(x, y)) <span class="op">+</span></a>
<a class="sourceLine" id="cb34-74" title="74"><span class="st">    </span><span class="kw">geom_tile</span>(<span class="kw">aes</span>(<span class="dt">fill =</span> <span class="kw"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span>(module), <span class="dt">color =</span> <span class="kw"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span>(module)),</a>
<a class="sourceLine" id="cb34-75" title="75">              <span class="dt">alpha =</span> <span class="fl">0.8</span>, <span class="dt">width =</span> <span class="dv">1</span>, <span class="dt">height =</span> <span class="dv">1</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb34-76" title="76"><span class="st">    </span><span class="kw">scale_color_brewer</span>(<span class="st">"Bioregions"</span>, <span class="dt">palette =</span> <span class="st">"Paired"</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb34-77" title="77"><span class="st">    </span><span class="kw">scale_fill_brewer</span>(<span class="st">"Bioregions"</span>, <span class="dt">palette =</span> <span class="st">"Paired"</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb34-78" title="78"><span class="st">    </span><span class="kw">coord_equal</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb34-79" title="79"><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">"Infomap bioregions"</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb34-80" title="80"><span class="st">    </span><span class="kw">theme</span>(<span class="dt">panel.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">"transparent"</span>, <span class="dt">colour =</span> <span class="ot">NA</span>)),</a>
<a class="sourceLine" id="cb34-81" title="81">  </a>
<a class="sourceLine" id="cb34-82" title="82">  <span class="dt">nrow =</span> <span class="dv">2</span>)</a></code></pre></div>
<p><img src="tutorial_files/figure-html/map_virtual_dataset-1.png" width="768"></p>
</div>
<div id="identical-plots" class="section level2">
<h2 class="hasAnchor">
<a href="#identical-plots" class="anchor"></a>Identical plots</h2>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb35-1" title="1"><span class="co"># Gather all the bioregionalizations</span></a>
<a class="sourceLine" id="cb35-2" title="2">all_bioregions &lt;-<span class="st"> </span>sp_df <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb35-3" title="3"><span class="st">  </span><span class="kw">select</span>(site, x, y, env) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb35-4" title="4"><span class="st">  </span><span class="kw">distinct</span>(site, <span class="dt">.keep_all =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb35-5" title="5"><span class="st">  </span><span class="kw">left_join</span>(oslom_vignette, <span class="dt">by =</span> <span class="st">"site"</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># add OSLOM</span></a>
<a class="sourceLine" id="cb35-6" title="6"><span class="st">  </span><span class="kw">rename</span>(<span class="dt">oslom =</span> bioregion) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb35-7" title="7"><span class="st">  </span><span class="kw">left_join</span>(ward_res, <span class="dt">by =</span> <span class="st">"site"</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># add Ward</span></a>
<a class="sourceLine" id="cb35-8" title="8"><span class="st">  </span><span class="kw">rename</span>(<span class="dt">ward =</span> cluster) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb35-9" title="9"><span class="st">  </span><span class="kw">left_join</span>(bip_site, <span class="dt">by =</span> <span class="st">"site"</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># add greedy</span></a>
<a class="sourceLine" id="cb35-10" title="10"><span class="st">  </span><span class="kw">distinct</span>(site, <span class="dt">.keep_all =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb35-11" title="11"><span class="st">  </span><span class="kw">rename</span>(<span class="dt">greedy =</span> module) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb35-12" title="12"><span class="st">  </span><span class="kw">left_join</span>(bip_site2, <span class="dt">by =</span> <span class="st">"site"</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># add LPAwb</span></a>
<a class="sourceLine" id="cb35-13" title="13"><span class="st">  </span><span class="kw">distinct</span>(site, <span class="dt">.keep_all =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb35-14" title="14"><span class="st">  </span><span class="kw">rename</span>(<span class="dt">lpawb =</span> module) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb35-15" title="15"><span class="st">  </span><span class="kw">left_join</span>(bip_site_infomap, <span class="dt">by =</span> <span class="st">"site"</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># add infomap</span></a>
<a class="sourceLine" id="cb35-16" title="16"><span class="st">  </span><span class="kw">distinct</span>(site, <span class="dt">.keep_all =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb35-17" title="17"><span class="st">  </span><span class="kw">rename</span>(<span class="dt">infomap =</span> module)</a>
<a class="sourceLine" id="cb35-18" title="18"></a>
<a class="sourceLine" id="cb35-19" title="19"><span class="co"># Test of comparison function</span></a>
<a class="sourceLine" id="cb35-20" title="20">all100 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/comparison.html">comparison</a></span>(all_bioregions, <span class="dt">bio_col =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">5</span><span class="op">:</span><span class="dv">9</span>))</a>
<a class="sourceLine" id="cb35-21" title="21"></a>
<a class="sourceLine" id="cb35-22" title="22"><span class="co"># Comparison of maps</span></a>
<a class="sourceLine" id="cb35-23" title="23"><span class="kw">plot_grid</span>(</a>
<a class="sourceLine" id="cb35-24" title="24">  <span class="co"># Plot of OSLOM bioregions</span></a>
<a class="sourceLine" id="cb35-25" title="25">  sp_df <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb35-26" title="26"><span class="st">    </span><span class="kw">left_join</span>(oslom_vignette, <span class="dt">by =</span> <span class="st">"site"</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb35-27" title="27"><span class="st">    </span><span class="kw">distinct</span>(site, <span class="dt">.keep_all =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb35-28" title="28"><span class="st">    </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(x, y)) <span class="op">+</span></a>
<a class="sourceLine" id="cb35-29" title="29"><span class="st">    </span><span class="kw">geom_tile</span>(<span class="kw">aes</span>(<span class="dt">fill =</span> <span class="kw"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span>(bioregion), <span class="dt">color =</span> <span class="kw"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span>(bioregion)),</a>
<a class="sourceLine" id="cb35-30" title="30">              <span class="dt">alpha =</span> <span class="fl">0.8</span>, <span class="dt">width =</span> <span class="dv">1</span>, <span class="dt">height =</span> <span class="dv">1</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb35-31" title="31"><span class="st">    </span><span class="kw">scale_color_brewer</span>(<span class="st">"Bioregions"</span>, <span class="dt">palette =</span> <span class="st">"Paired"</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb35-32" title="32"><span class="st">    </span><span class="kw">scale_fill_brewer</span>(<span class="st">"Bioregions"</span>, <span class="dt">palette =</span> <span class="st">"Paired"</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb35-33" title="33"><span class="st">    </span><span class="co"># scale_color_viridis_d("Bioregions", option = "E") +</span></a>
<a class="sourceLine" id="cb35-34" title="34"><span class="st">    </span><span class="co"># scale_fill_viridis_d("Bioregions", option = "E") +</span></a>
<a class="sourceLine" id="cb35-35" title="35"><span class="st">    </span><span class="kw">coord_equal</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb35-36" title="36"><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">"OSLOM bioregions"</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb35-37" title="37"><span class="st">    </span><span class="kw">theme</span>(<span class="dt">panel.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">"transparent"</span>,</a>
<a class="sourceLine" id="cb35-38" title="38">                                          <span class="dt">colour =</span> <span class="st">"black"</span>)),</a>
<a class="sourceLine" id="cb35-39" title="39">  </a>
<a class="sourceLine" id="cb35-40" title="40">  <span class="co"># Identical pairs of plots</span></a>
<a class="sourceLine" id="cb35-41" title="41">  all100 <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb35-42" title="42"><span class="st">    </span><span class="kw">left_join</span>(all_bioregions[, <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"site"</span>, <span class="st">"x"</span>, <span class="st">"y"</span>)], <span class="dt">by =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"id1"</span> =<span class="st"> "site"</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb35-43" title="43"><span class="st">    </span><span class="kw">distinct</span>(id1, <span class="dt">.keep_all =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb35-44" title="44"><span class="st">    </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(x, y)) <span class="op">+</span></a>
<a class="sourceLine" id="cb35-45" title="45"><span class="st">    </span><span class="kw">geom_tile</span>(<span class="kw">aes</span>(<span class="dt">fill =</span> <span class="kw"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span>(pair_bio), <span class="dt">color =</span> <span class="kw"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span>(pair_bio)),</a>
<a class="sourceLine" id="cb35-46" title="46">              <span class="dt">alpha =</span> <span class="fl">0.8</span>, <span class="dt">width =</span> <span class="dv">1</span>, <span class="dt">height =</span> <span class="dv">1</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb35-47" title="47"><span class="st">    </span><span class="kw">scale_color_viridis_d</span>(<span class="st">"Bioregions"</span>, <span class="dt">option =</span> <span class="st">"E"</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb35-48" title="48"><span class="st">    </span><span class="kw">scale_fill_viridis_d</span>(<span class="st">"Bioregions"</span>, <span class="dt">option =</span> <span class="st">"E"</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb35-49" title="49"><span class="st">    </span><span class="co"># scale_color_brewer("Bioregions", palette = "Paired") +</span></a>
<a class="sourceLine" id="cb35-50" title="50"><span class="st">    </span><span class="co"># scale_fill_brewer("Bioregions", palette = "Paired") +</span></a>
<a class="sourceLine" id="cb35-51" title="51"><span class="st">    </span><span class="kw">coord_equal</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb35-52" title="52"><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">"Identical bioregions"</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb35-53" title="53"><span class="st">    </span><span class="kw">theme</span>(<span class="dt">panel.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">"transparent"</span>, <span class="dt">colour =</span> <span class="ot">NA</span>)),</a>
<a class="sourceLine" id="cb35-54" title="54">  </a>
<a class="sourceLine" id="cb35-55" title="55">  <span class="co"># Plot of Ward bioregions</span></a>
<a class="sourceLine" id="cb35-56" title="56">  sp_df <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb35-57" title="57"><span class="st">    </span><span class="kw">left_join</span>(ward_res, <span class="dt">by =</span> <span class="st">"site"</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb35-58" title="58"><span class="st">    </span><span class="kw">distinct</span>(site, <span class="dt">.keep_all =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb35-59" title="59"><span class="st">    </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(x, y)) <span class="op">+</span></a>
<a class="sourceLine" id="cb35-60" title="60"><span class="st">    </span><span class="kw">geom_tile</span>(<span class="kw">aes</span>(<span class="dt">fill =</span> <span class="kw"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span>(cluster), <span class="dt">color =</span> <span class="kw"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span>(cluster)),</a>
<a class="sourceLine" id="cb35-61" title="61">              <span class="dt">alpha =</span> <span class="fl">0.8</span>, <span class="dt">width =</span> <span class="dv">1</span>, <span class="dt">height =</span> <span class="dv">1</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb35-62" title="62"><span class="st">    </span><span class="kw">scale_color_brewer</span>(<span class="st">"Bioregions"</span>, <span class="dt">palette =</span> <span class="st">"Paired"</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb35-63" title="63"><span class="st">    </span><span class="kw">scale_fill_brewer</span>(<span class="st">"Bioregions"</span>, <span class="dt">palette =</span> <span class="st">"Paired"</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb35-64" title="64"><span class="st">    </span><span class="kw">coord_equal</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb35-65" title="65"><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">"Ward bioregions"</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb35-66" title="66"><span class="st">    </span><span class="kw">theme</span>(<span class="dt">panel.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">"transparent"</span>, <span class="dt">colour =</span> <span class="ot">NA</span>)),</a>
<a class="sourceLine" id="cb35-67" title="67">  </a>
<a class="sourceLine" id="cb35-68" title="68">  <span class="co"># Plot of fastgreedy bioregions</span></a>
<a class="sourceLine" id="cb35-69" title="69">  sp_df <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb35-70" title="70"><span class="st">    </span><span class="kw">left_join</span>(bip_site, <span class="dt">by =</span> <span class="st">"site"</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb35-71" title="71"><span class="st">    </span><span class="kw">distinct</span>(site, <span class="dt">.keep_all =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb35-72" title="72"><span class="st">    </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(x, y)) <span class="op">+</span></a>
<a class="sourceLine" id="cb35-73" title="73"><span class="st">    </span><span class="kw">geom_tile</span>(<span class="kw">aes</span>(<span class="dt">fill =</span> <span class="kw"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span>(module), <span class="dt">color =</span> <span class="kw"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span>(module)),</a>
<a class="sourceLine" id="cb35-74" title="74">              <span class="dt">alpha =</span> <span class="fl">0.8</span>, <span class="dt">width =</span> <span class="dv">1</span>, <span class="dt">height =</span> <span class="dv">1</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb35-75" title="75"><span class="st">    </span><span class="kw">scale_color_brewer</span>(<span class="st">"Bioregions"</span>, <span class="dt">palette =</span> <span class="st">"Paired"</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb35-76" title="76"><span class="st">    </span><span class="kw">scale_fill_brewer</span>(<span class="st">"Bioregions"</span>, <span class="dt">palette =</span> <span class="st">"Paired"</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb35-77" title="77"><span class="st">    </span><span class="kw">coord_equal</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb35-78" title="78"><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">"Bipartite greedy bioregions"</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb35-79" title="79"><span class="st">    </span><span class="kw">theme</span>(<span class="dt">panel.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">"transparent"</span>, <span class="dt">colour =</span> <span class="ot">NA</span>)),</a>
<a class="sourceLine" id="cb35-80" title="80">  </a>
<a class="sourceLine" id="cb35-81" title="81">  <span class="co"># Plot of LPAwb bioregions</span></a>
<a class="sourceLine" id="cb35-82" title="82">  sp_df <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb35-83" title="83"><span class="st">    </span><span class="kw">left_join</span>(bip_site2, <span class="dt">by =</span> <span class="st">"site"</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb35-84" title="84"><span class="st">    </span><span class="kw">distinct</span>(site, <span class="dt">.keep_all =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb35-85" title="85"><span class="st">    </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(x, y)) <span class="op">+</span></a>
<a class="sourceLine" id="cb35-86" title="86"><span class="st">    </span><span class="kw">geom_tile</span>(<span class="kw">aes</span>(<span class="dt">fill =</span> <span class="kw"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span>(module), <span class="dt">color =</span> <span class="kw"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span>(module)),</a>
<a class="sourceLine" id="cb35-87" title="87">              <span class="dt">alpha =</span> <span class="fl">0.8</span>, <span class="dt">width =</span> <span class="dv">1</span>, <span class="dt">height =</span> <span class="dv">1</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb35-88" title="88"><span class="st">    </span><span class="kw">scale_color_brewer</span>(<span class="st">"Bioregions"</span>, <span class="dt">palette =</span> <span class="st">"Paired"</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb35-89" title="89"><span class="st">    </span><span class="kw">scale_fill_brewer</span>(<span class="st">"Bioregions"</span>, <span class="dt">palette =</span> <span class="st">"Paired"</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb35-90" title="90"><span class="st">    </span><span class="kw">coord_equal</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb35-91" title="91"><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">"LPAwb+ greedy bioregions"</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb35-92" title="92"><span class="st">    </span><span class="kw">theme</span>(<span class="dt">panel.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">"transparent"</span>, <span class="dt">colour =</span> <span class="ot">NA</span>)),</a>
<a class="sourceLine" id="cb35-93" title="93">  </a>
<a class="sourceLine" id="cb35-94" title="94">  <span class="co"># Plot of Infomap bioregions</span></a>
<a class="sourceLine" id="cb35-95" title="95">  sp_df <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb35-96" title="96"><span class="st">    </span><span class="kw">left_join</span>(bip_site_infomap, <span class="dt">by =</span> <span class="st">"site"</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb35-97" title="97"><span class="st">    </span><span class="kw">distinct</span>(site, <span class="dt">.keep_all =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb35-98" title="98"><span class="st">    </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(x, y)) <span class="op">+</span></a>
<a class="sourceLine" id="cb35-99" title="99"><span class="st">    </span><span class="kw">geom_tile</span>(<span class="kw">aes</span>(<span class="dt">fill =</span> <span class="kw"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span>(module), <span class="dt">color =</span> <span class="kw"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span>(module)),</a>
<a class="sourceLine" id="cb35-100" title="100">              <span class="dt">alpha =</span> <span class="fl">0.8</span>, <span class="dt">width =</span> <span class="dv">1</span>, <span class="dt">height =</span> <span class="dv">1</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb35-101" title="101"><span class="st">    </span><span class="kw">scale_color_brewer</span>(<span class="st">"Bioregions"</span>, <span class="dt">palette =</span> <span class="st">"Paired"</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb35-102" title="102"><span class="st">    </span><span class="kw">scale_fill_brewer</span>(<span class="st">"Bioregions"</span>, <span class="dt">palette =</span> <span class="st">"Paired"</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb35-103" title="103"><span class="st">    </span><span class="kw">coord_equal</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb35-104" title="104"><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">"Infomap bioregions"</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb35-105" title="105"><span class="st">    </span><span class="kw">theme</span>(<span class="dt">panel.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">"transparent"</span>, <span class="dt">colour =</span> <span class="ot">NA</span>)),</a>
<a class="sourceLine" id="cb35-106" title="106">  </a>
<a class="sourceLine" id="cb35-107" title="107">  <span class="dt">nrow =</span> <span class="dv">2</span>)</a></code></pre></div>
<p><img src="tutorial_files/figure-html/comparison-1.png" width="768"></p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb36-1" title="1"><span class="co"># Plot with tiles</span></a>
<a class="sourceLine" id="cb36-2" title="2">all100 <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb36-3" title="3"><span class="st">  </span><span class="kw">left_join</span>(all_bioregions[, <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"site"</span>, <span class="st">"x"</span>, <span class="st">"y"</span>)], <span class="dt">by =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"id1"</span> =<span class="st"> "site"</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb36-4" title="4"><span class="st">  </span><span class="kw">distinct</span>(id1, <span class="dt">.keep_all =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb36-5" title="5"><span class="st">  </span><span class="kw">st_as_sf</span>(<span class="dt">coords =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"x"</span>, <span class="st">"y"</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb36-6" title="6"><span class="st">  </span><span class="kw">group_by</span>(pair_bio) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb36-7" title="7"><span class="st">  </span><span class="kw">st_cast</span>(<span class="st">"MULTIPOINT"</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb36-8" title="8"><span class="st">  </span><span class="kw">summarise</span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb36-9" title="9"><span class="st">  </span><span class="kw">ggplot</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb36-10" title="10"><span class="st">  </span><span class="kw">geom_sf</span>(<span class="kw">aes</span>(<span class="dt">color =</span> <span class="kw"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span>(pair_bio)))</a></code></pre></div>
<p><img src="tutorial_files/figure-html/comparison-2.png" width="768"></p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb37-1" title="1"><span class="kw">geom_tile</span>(<span class="kw">aes</span>(<span class="dt">fill =</span> <span class="kw"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span>(pair_bio), <span class="dt">color =</span> <span class="kw"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span>(pair_bio)),</a>
<a class="sourceLine" id="cb37-2" title="2">          <span class="dt">alpha =</span> <span class="fl">0.8</span>, <span class="dt">width =</span> <span class="dv">1</span>, <span class="dt">height =</span> <span class="dv">1</span>)</a></code></pre></div>
<pre><code>## mapping: fill = ~as.factor(pair_bio), colour = ~as.factor(pair_bio) 
## geom_tile: linejoin = mitre, na.rm = FALSE
## stat_identity: na.rm = FALSE
## position_identity</code></pre>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb39-1" title="1"><span class="co">## Autocorrelation</span></a>
<a class="sourceLine" id="cb39-2" title="2"><span class="co"># https://mgimond.github.io/Spatial/spatial-autocorrelation-in-r.html</span></a>
<a class="sourceLine" id="cb39-3" title="3"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(sp)</a>
<a class="sourceLine" id="cb39-4" title="4">all_bioregions_sp &lt;-<span class="st"> </span>all_bioregions</a>
<a class="sourceLine" id="cb39-5" title="5">all_bioregions_sp &lt;-<span class="st"> </span>all_bioregions_sp[<span class="kw"><a href="https://rdrr.io/r/stats/complete.cases.html">complete.cases</a></span>(all_bioregions_sp), ]</a>
<a class="sourceLine" id="cb39-6" title="6"><span class="kw">coordinates</span>(all_bioregions_sp) &lt;-<span class="st"> </span><span class="er">~</span>x<span class="op">+</span>y</a>
<a class="sourceLine" id="cb39-7" title="7"></a>
<a class="sourceLine" id="cb39-8" title="8">all_bioregions_sp<span class="op">$</span>oslom &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/character.html">as.character</a></span>(all_bioregions_sp<span class="op">$</span>oslom))</a>
<a class="sourceLine" id="cb39-9" title="9">all_bioregions_sp<span class="op">$</span>ward &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/character.html">as.character</a></span>(all_bioregions_sp<span class="op">$</span>ward))</a>
<a class="sourceLine" id="cb39-10" title="10">all_bioregions_sp<span class="op">$</span>greedy &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/character.html">as.character</a></span>(all_bioregions_sp<span class="op">$</span>greedy))</a>
<a class="sourceLine" id="cb39-11" title="11">all_bioregions_sp<span class="op">$</span>lpawb &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/character.html">as.character</a></span>(all_bioregions_sp<span class="op">$</span>lpawb))</a>
<a class="sourceLine" id="cb39-12" title="12">all_bioregions_sp<span class="op">$</span>infomap &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/character.html">as.character</a></span>(all_bioregions_sp<span class="op">$</span>infomap))</a>
<a class="sourceLine" id="cb39-13" title="13"></a>
<a class="sourceLine" id="cb39-14" title="14">coo &lt;-<span class="st"> </span><span class="kw">coordinates</span>(all_bioregions_sp)</a>
<a class="sourceLine" id="cb39-15" title="15"><span class="co"># S.dist  &lt;-  spdep::dnearneigh(coo, 0, 100)</span></a>
<a class="sourceLine" id="cb39-16" title="16"><span class="co"># lw &lt;- spdep::nb2listw(S.dist, style="W",zero.policy=T) </span></a>
<a class="sourceLine" id="cb39-17" title="17"><span class="co"># MI  &lt;-  spdep::moran.mc(all_bioregions_sp$oslom, lw, nsim=599,zero.policy=T)</span></a>
<a class="sourceLine" id="cb39-18" title="18"><span class="co"># plot(MI, main = "", las = 1) </span></a>
<a class="sourceLine" id="cb39-19" title="19"></a>
<a class="sourceLine" id="cb39-20" title="20">bws &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">6</span>, <span class="dv">9</span>, <span class="dv">12</span>, <span class="dv">18</span>, <span class="dv">24</span>)</a>
<a class="sourceLine" id="cb39-21" title="21">moran_oslom &lt;-<span class="st"> </span>lctools<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/lctools/man/moransI.v.html">moransI.v</a></span>(coo, bws, all_bioregions_sp<span class="op">@</span>data<span class="op">$</span>oslom,</a>
<a class="sourceLine" id="cb39-22" title="22">                                  <span class="dt">plot =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb39-23" title="23">moran_ward &lt;-<span class="st"> </span>lctools<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/lctools/man/moransI.v.html">moransI.v</a></span>(coo, bws, all_bioregions_sp<span class="op">@</span>data<span class="op">$</span>ward,</a>
<a class="sourceLine" id="cb39-24" title="24">                                 <span class="dt">plot =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb39-25" title="25">moran_greedy &lt;-<span class="st"> </span>lctools<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/lctools/man/moransI.v.html">moransI.v</a></span>(coo, bws, all_bioregions_sp<span class="op">@</span>data<span class="op">$</span>greedy,</a>
<a class="sourceLine" id="cb39-26" title="26">                                   <span class="dt">plot =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb39-27" title="27">moran_lpawb &lt;-<span class="st"> </span>lctools<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/lctools/man/moransI.v.html">moransI.v</a></span>(coo, bws, all_bioregions_sp<span class="op">@</span>data<span class="op">$</span>lpawb,</a>
<a class="sourceLine" id="cb39-28" title="28">                                  <span class="dt">plot =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb39-29" title="29">moran_infomap &lt;-<span class="st"> </span>lctools<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/lctools/man/moransI.v.html">moransI.v</a></span>(coo, bws, all_bioregions_sp<span class="op">@</span>data<span class="op">$</span>infomap,</a>
<a class="sourceLine" id="cb39-30" title="30">                                    <span class="dt">plot =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb39-31" title="31"></a>
<a class="sourceLine" id="cb39-32" title="32">all_moran &lt;-</a>
<a class="sourceLine" id="cb39-33" title="33"><span class="st">  </span><span class="kw"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(</a>
<a class="sourceLine" id="cb39-34" title="34">    <span class="dt">algo =</span> <span class="st">"oslom"</span>, <span class="dt">k =</span> moran_oslom[, <span class="st">"k"</span>],</a>
<a class="sourceLine" id="cb39-35" title="35">    <span class="dt">moran =</span> moran_oslom[, <span class="st">"Moran's I"</span>]),</a>
<a class="sourceLine" id="cb39-36" title="36">    <span class="kw"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="dt">algo =</span> <span class="st">"ward"</span>, <span class="dt">k =</span> moran_ward[, <span class="st">"k"</span>],</a>
<a class="sourceLine" id="cb39-37" title="37">               <span class="dt">moran =</span> moran_ward[, <span class="st">"Moran's I"</span>]),</a>
<a class="sourceLine" id="cb39-38" title="38">    <span class="kw"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="dt">algo =</span> <span class="st">"ward"</span>, <span class="dt">k =</span> moran_ward[, <span class="st">"k"</span>],</a>
<a class="sourceLine" id="cb39-39" title="39">               <span class="dt">moran =</span> moran_greedy[, <span class="st">"Moran's I"</span>]),</a>
<a class="sourceLine" id="cb39-40" title="40">    <span class="kw"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="dt">algo =</span> <span class="st">"greedy"</span>, <span class="dt">k =</span> moran_greedy[, <span class="st">"k"</span>],</a>
<a class="sourceLine" id="cb39-41" title="41">               <span class="dt">moran =</span> moran_lpawb[, <span class="st">"Moran's I"</span>]),</a>
<a class="sourceLine" id="cb39-42" title="42">    <span class="kw"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="dt">algo =</span> <span class="st">"infomap"</span>, <span class="dt">k =</span> moran_infomap[, <span class="st">"k"</span>],</a>
<a class="sourceLine" id="cb39-43" title="43">               <span class="dt">moran =</span> moran_infomap[, <span class="st">"Moran's I"</span>])</a>
<a class="sourceLine" id="cb39-44" title="44">  )</a>
<a class="sourceLine" id="cb39-45" title="45"></a>
<a class="sourceLine" id="cb39-46" title="46"><span class="kw">ggplot</span>(all_moran, <span class="kw">aes</span>(k, moran)) <span class="op">+</span></a>
<a class="sourceLine" id="cb39-47" title="47"><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">color =</span> <span class="kw"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span>(algo))) <span class="op">+</span></a>
<a class="sourceLine" id="cb39-48" title="48"><span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">color =</span> <span class="kw"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span>(algo))) <span class="op">+</span></a>
<a class="sourceLine" id="cb39-49" title="49"><span class="st">  </span><span class="kw">scale_color_viridis_d</span>(<span class="st">"Method"</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb39-50" title="50"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">"# of neighbours"</span>, <span class="dt">y =</span> <span class="st">"Moran's I"</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb39-51" title="51"><span class="st">  </span><span class="kw">theme_classic</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb39-52" title="52"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.border =</span> <span class="kw">element_rect</span>(<span class="dt">fill=</span> <span class="ot">NA</span>, <span class="dt">color =</span> <span class="st">"black"</span>))</a></code></pre></div>
<p><img src="tutorial_files/figure-html/autocorrelation-1.png" width="768"></p>
<p>We can as well compare each pair of bioregion to each other.</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb40-1" title="1"><span class="co"># sabre package: test between oslom and ward</span></a>
<a class="sourceLine" id="cb40-2" title="2"><span class="co"># Spatial Association Between REgionalizations</span></a>
<a class="sourceLine" id="cb40-3" title="3"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(sabre)</a>
<a class="sourceLine" id="cb40-4" title="4"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(sf)</a>
<a class="sourceLine" id="cb40-5" title="5"></a>
<a class="sourceLine" id="cb40-6" title="6">bioregions_sf &lt;-<span class="st"> </span><span class="kw">st_as_sf</span>(all_bioregions, <span class="dt">coords =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"x"</span>, <span class="st">"y"</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb40-7" title="7"><span class="st">  </span><span class="kw">st_cast</span>(<span class="dt">to =</span> <span class="st">"MULTILINESTRING"</span>)</a>
<a class="sourceLine" id="cb40-8" title="8"></a>
<a class="sourceLine" id="cb40-9" title="9">po &lt;-<span class="st"> </span><span class="kw">vmeasure_calc</span>(<span class="dt">x =</span> bioregions_sf, <span class="dt">x_name =</span> oslom,</a>
<a class="sourceLine" id="cb40-10" title="10">                    <span class="dt">y =</span> bioregions_sf, <span class="dt">y_name =</span> ward)</a>
<a class="sourceLine" id="cb40-11" title="11"></a>
<a class="sourceLine" id="cb40-12" title="12"><span class="co"># Groups of pixels through the different methods</span></a>
<a class="sourceLine" id="cb40-13" title="13">list_group_oslom &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/by.html">by</a></span>(all_bioregions<span class="op">$</span>site, all_bioregions<span class="op">$</span>oslom, identity)</a>
<a class="sourceLine" id="cb40-14" title="14">list_group_oslom &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span>(list_group_oslom, as.character)</a>
<a class="sourceLine" id="cb40-15" title="15"></a>
<a class="sourceLine" id="cb40-16" title="16">list_group_ward &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/by.html">by</a></span>(all_bioregions<span class="op">$</span>site, all_bioregions<span class="op">$</span>ward, identity)</a>
<a class="sourceLine" id="cb40-17" title="17">list_group_ward &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span>(list_group_ward, as.character)</a>
<a class="sourceLine" id="cb40-18" title="18"></a>
<a class="sourceLine" id="cb40-19" title="19">list_group_greedy &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/by.html">by</a></span>(all_bioregions<span class="op">$</span>site, all_bioregions<span class="op">$</span>greedy, identity)</a>
<a class="sourceLine" id="cb40-20" title="20">list_group_greedy&lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span>(list_group_greedy, as.character)</a>
<a class="sourceLine" id="cb40-21" title="21"></a>
<a class="sourceLine" id="cb40-22" title="22">list_group_lpawb &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/by.html">by</a></span>(all_bioregions<span class="op">$</span>site, all_bioregions<span class="op">$</span>lpawb, identity)</a>
<a class="sourceLine" id="cb40-23" title="23">list_group_lpawb &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span>(list_group_lpawb, as.character)</a>
<a class="sourceLine" id="cb40-24" title="24"></a>
<a class="sourceLine" id="cb40-25" title="25">list_group_infomap &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/by.html">by</a></span>(all_bioregions<span class="op">$</span>site, all_bioregions<span class="op">$</span>infomap, identity)</a>
<a class="sourceLine" id="cb40-26" title="26">list_group_infomap &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span>(list_group_infomap, as.character)</a>
<a class="sourceLine" id="cb40-27" title="27"></a>
<a class="sourceLine" id="cb40-28" title="28">list_combined &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span>(list_group_oslom, <span class="cf">function</span>(x) x[x <span class="op">%in%</span><span class="st"> </span>list_group_ward[[<span class="dv">1</span>]]])</a>
<a class="sourceLine" id="cb40-29" title="29">list_combined &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span>(list_combined, <span class="cf">function</span>(x) x[x <span class="op">%in%</span><span class="st"> </span>list_group_greedy[[<span class="dv">1</span>]]])</a>
<a class="sourceLine" id="cb40-30" title="30">list_combined &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span>(list_combined, <span class="cf">function</span>(x) x[x <span class="op">%in%</span><span class="st"> </span>list_group_lpawb[[<span class="dv">1</span>]]])</a>
<a class="sourceLine" id="cb40-31" title="31">list_combined &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span>(list_combined, <span class="cf">function</span>(x) x[x <span class="op">%in%</span><span class="st"> </span>list_group_infomap[[<span class="dv">1</span>]]])</a>
<a class="sourceLine" id="cb40-32" title="32"></a>
<a class="sourceLine" id="cb40-33" title="33"><span class="co"># For one combination only</span></a>
<a class="sourceLine" id="cb40-34" title="34">list1_oslom &lt;-</a>
<a class="sourceLine" id="cb40-35" title="35"><span class="st">  </span>all_bioregions[<span class="kw"><a href="https://rdrr.io/r/base/which.html">which</a></span>(all_bioregions<span class="op">$</span>oslom <span class="op">==</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/unique.html">unique</a></span>(all_bioregions<span class="op">$</span>oslom)[<span class="dv">1</span>]),</a>
<a class="sourceLine" id="cb40-36" title="36">                 <span class="st">"site"</span>]</a>
<a class="sourceLine" id="cb40-37" title="37">list1_ward &lt;-<span class="st"> </span>all_bioregions[<span class="kw"><a href="https://rdrr.io/r/base/which.html">which</a></span>(all_bioregions<span class="op">$</span>ward <span class="op">==</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/unique.html">unique</a></span>(all_bioregions<span class="op">$</span>ward)[<span class="dv">1</span>]),</a>
<a class="sourceLine" id="cb40-38" title="38">                             <span class="st">"site"</span>]</a>
<a class="sourceLine" id="cb40-39" title="39">list1_greedy &lt;-<span class="st"> </span>all_bioregions[<span class="kw"><a href="https://rdrr.io/r/base/which.html">which</a></span>(all_bioregions<span class="op">$</span>greedy <span class="op">==</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/unique.html">unique</a></span>(all_bioregions<span class="op">$</span>greedy)[<span class="dv">1</span>]),</a>
<a class="sourceLine" id="cb40-40" title="40">                               <span class="st">"site"</span>]</a>
<a class="sourceLine" id="cb40-41" title="41">list1_lpawb &lt;-<span class="st"> </span>all_bioregions[<span class="kw"><a href="https://rdrr.io/r/base/which.html">which</a></span>(all_bioregions<span class="op">$</span>lpawb <span class="op">==</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/unique.html">unique</a></span>(all_bioregions<span class="op">$</span>lpawb)[<span class="dv">1</span>]),</a>
<a class="sourceLine" id="cb40-42" title="42">                              <span class="st">"site"</span>]</a>
<a class="sourceLine" id="cb40-43" title="43">list1_infomap &lt;-<span class="st"> </span>all_bioregions[<span class="kw"><a href="https://rdrr.io/r/base/which.html">which</a></span>(all_bioregions<span class="op">$</span>infomap <span class="op">==</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/unique.html">unique</a></span>(all_bioregions<span class="op">$</span>infomap)[<span class="dv">1</span>]),</a>
<a class="sourceLine" id="cb40-44" title="44">                                <span class="st">"site"</span>]</a>
<a class="sourceLine" id="cb40-45" title="45"></a>
<a class="sourceLine" id="cb40-46" title="46">list1_combined &lt;-<span class="st"> </span>list1_oslom[list1_oslom <span class="op">%in%</span><span class="st"> </span>list1_ward]</a>
<a class="sourceLine" id="cb40-47" title="47">list1_combined &lt;-<span class="st"> </span>list1_combined[list1_combined <span class="op">%in%</span><span class="st"> </span>list1_greedy]</a>
<a class="sourceLine" id="cb40-48" title="48">list1_combined &lt;-<span class="st"> </span>list1_combined[list1_combined <span class="op">%in%</span><span class="st"> </span>list1_lpawb]</a>
<a class="sourceLine" id="cb40-49" title="49">list1_combined &lt;-<span class="st"> </span>list1_combined[list1_combined <span class="op">%in%</span><span class="st"> </span>list1_infomap]</a>
<a class="sourceLine" id="cb40-50" title="50"></a>
<a class="sourceLine" id="cb40-51" title="51">all_bioregions<span class="op">$</span>combined &lt;-<span class="st"> </span><span class="ot">NA</span></a>
<a class="sourceLine" id="cb40-52" title="52">all_bioregions[<span class="kw"><a href="https://rdrr.io/r/base/which.html">which</a></span>(all_bioregions<span class="op">$</span>site <span class="op">%in%</span><span class="st"> </span>list1_combined), <span class="st">"combined"</span>] &lt;-<span class="st"> "1"</span></a></code></pre></div>
</div>
</div>
<div id="run-all-the-steps-together" class="section level1">
<h1 class="hasAnchor">
<a href="#run-all-the-steps-together" class="anchor"></a>Run all the steps together</h1>
<p>All these functions can be called with the wrap-up <code><a href="../reference/all_maps.html">all_maps()</a></code> function.</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb41-1" title="1">all_res &lt;-<span class="st"> </span><span class="kw"><a href="../reference/all_maps.html">all_maps</a></span>(<span class="dt">dat =</span> sp_df, <span class="dt">form =</span> <span class="st">"tidy"</span>, site, sp, <span class="dt">ab =</span> <span class="ot">NULL</span>,</a>
<a class="sourceLine" id="cb41-2" title="2">                    <span class="dt">binary =</span> <span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb41-3" title="3">                    <span class="dt">similarity =</span> <span class="st">"simpson"</span>, <span class="dt">network_algo =</span> <span class="st">"both"</span>,</a>
<a class="sourceLine" id="cb41-4" title="4">                    saving_directory,</a>
<a class="sourceLine" id="cb41-5" title="5">                    <span class="dt">bipartite_algo =</span> <span class="st">"greedy"</span>, <span class="dt">weight =</span> <span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb41-6" title="6">                    <span class="dt">clustering =</span> <span class="ot">TRUE</span>, <span class="dt">ward_method =</span> <span class="st">"ward.D2"</span>,</a>
<a class="sourceLine" id="cb41-7" title="7">                    <span class="dt">optim_method =</span> <span class="st">"firstSEmax"</span>, <span class="dt">nstart =</span> <span class="dv">25</span>, <span class="dt">B =</span> <span class="dv">50</span>,</a>
<a class="sourceLine" id="cb41-8" title="8">                    <span class="dt">K.max =</span> <span class="dv">20</span>)</a></code></pre></div>
</div>
<div id="references" class="section level1">
<h1 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h1>
<p>Guimerà, R., Nunes Amaral, L. Functional cartography of complex metabolic networks. Nature 433, 895–900 (2005). <a href="https://doi.org/10.1038/nature03288" class="uri">https://doi.org/10.1038/nature03288</a></p>
<p>Lancichinetti A, Radicchi F, Ramasco JJ, Fortunato S (2011) Finding Statistically Significant Communities in Networks. PLoS ONE 6(4): e18961. <a href="https://doi.org/10.1371/journal.pone.0018961" class="uri">https://doi.org/10.1371/journal.pone.0018961</a></p>
<p>Leroy, B., Meynard, C.N., Bellard, C. and Courchamp, F. (2016), virtualspecies, an R package to generate virtual species distributions. Ecography, 39: 599-607. <a href="doi:10.1111/ecog.01388" class="uri">doi:10.1111/ecog.01388</a></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">

        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#virtual-dataset">Virtual dataset</a></li>
      <li><a href="#inputs-of-the-package">Inputs of the package</a></li>
      <li><a href="#community-detection">Community detection</a></li>
      <li><a href="#species-contributions">Species’ contributions</a></li>
      <li><a href="#interaction-between-bioregions">Interaction between bioregions</a></li>
      <li><a href="#comparison-of-different-bioregionalizations">Comparison of different bioregionalizations</a></li>
      <li><a href="#run-all-the-steps-together">Run all the steps together</a></li>
      <li><a href="#references">References</a></li>
      </ul>
</div>
      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Pierre Denelle.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
